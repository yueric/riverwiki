window.onerror=function(){return false};
function hdeditor_resize(a){if(HD.g[HD.id].suitsize!==false){var b=document.documentElement.clientWidth||document.body.clientWidth;if(!(HD.CW&&HD.CW==b)){HD.CW=b;var c=HD.util.isIE6(),d=document.getElementsByTagName("BODY")[0],e=document.getElementById("hd_container");HD.util.getDocOffsetWidth();if(b>1440){d.style.marginLeft="auto";d.style.marginRight="auto";e.style.width="1420px";e.style.left=(b-1440)/2+"px";if(c)d.style.width="1440px"}else{d.style.marginLeft="10px";d.style.marginRight="10px";e.style.width=
b-40+"px";e.style.left="10px"}if(c)e.style.left="0px";HD.util.autoToolbarTop(null,a)}}}
var UnloadConfirm={info:["\u60a8\u5bf9\u8bcd\u6761\u5185\u5bb9\u7684\u4fee\u6539\u8fd8\u6ca1\u6709\u8fdb\u884c\u4fdd\u5b58\uff01","\u60a8\u5bf9\u8bcd\u6761\u5185\u5bb9\u7684\u4fee\u6539\u5c1a\u672a\u53d1\u5e03\uff01"],set:function(a){var b=0;/hudong\.com/i.test(location.hostname)||(b=1);a=a||this.info[b];window.onbeforeunload=function(c){c=c||window.event;c.returnValue=a}},clear:function(){window.onbeforeunload=function(){}}},HD={};
HD.lang={save:"\u4fdd\u5b58",source:"\u67e5\u770b\u6e90\u7801",preview:"\u9884\u89c8",zoom:"\u653e\u5927",undo:"\u64a4\u9500 Ctrl+Z",redo:"\u91cd\u505a Ctrl+Y",cut:"\u526a\u5207 Ctrl+X",copy:"\u590d\u5236 Ctrl+C",dopaste:"\u7c98\u8d34\u6570\u636e",paste:"\u7c98\u8d34 Ctrl+V",plainpaste:"\u7c98\u8d34\u4e3a\u65e0\u683c\u5f0f\u6587\u672c",wordpaste:"\u4eceWord\u7c98\u8d34",selectall:"\u5168\u9009",justifymore:"\u5c45\u4e2d \u53f3\u5bf9\u9f50",justifyleft:"\u5de6\u5bf9\u9f50 Ctrl+L",justifycenter:"\u5c45\u4e2d Ctrl+E",
justifyright:"\u53f3\u5bf9\u9f50 Ctrl+R",justifyfull:"\u4e24\u7aef\u5bf9\u9f50",insertorderedlist:"\u7f16\u53f7",insertunorderedlist:"\u9879\u76ee\u7b26\u53f7",indent:"\u589e\u52a0\u7f29\u8fdb",outdent:"\u51cf\u5c11\u7f29\u8fdb",sub:"\u4e0b\u6807",sup:"\u4e0a\u6807",date:"\u63d2\u5165\u5f53\u524d\u65e5\u671f",time:"\u63d2\u5165\u5f53\u524d\u65f6\u95f4",title:"\u6807\u9898",title1:"\u4e00\u7ea7\u6807\u9898 Ctrl+1",title2:"\u4e8c\u7ea7\u6807\u9898 Ctrl+2",fontname:"\u5b57\u4f53",fontsize:"\u6587\u5b57\u5927\u5c0f",
textcolor:"\u6587\u5b57\u989c\u8272",bgcolor:"\u6587\u5b57\u80cc\u666f",fontstyle:"\u659c\u4f53 \u4e0b\u5212\u7ebf",bold:"\u7c97\u4f53 Ctrl+B",italic:"\u659c\u4f53 Ctrl+I",underline:"\u4e0b\u5212\u7ebf Ctrl+U",strikethrough:"\u5220\u9664\u7ebf",removeformat:"\u5220\u9664\u683c\u5f0f",image:"\u63d2\u5165\u56fe\u7247",multiimage:"\u6279\u91cf\u63d2\u5165\u56fe\u7247",flash:"\u63d2\u5165Flash",media:"\u63d2\u5165\u591a\u5a92\u4f53",layer:"\u63d2\u5165\u5c42",table:"\u8868\u683c",specialchar:"\u63d2\u5165\u7279\u6b8a\u5b57\u7b26",
hr:"\u63d2\u5165\u6a2a\u7ebf",emoticons:"\u63d2\u5165\u7b11\u8138",link:"\u8d85\u7ea7\u8fde\u63a5",innerlink:"\u5185\u90e8\u94fe\u63a5 Ctrl+Q",unlink:"\u53d6\u6d88\u8d85\u7ea7\u8fde\u63a5",fullscreen:"\u5168\u5c4f\u663e\u793a",about:"\u5173\u4e8e",print:"\u6253\u5370",yes:"\u786e\u5b9a",no:"\u53d6\u6d88",close:"\u5173\u95ed",clean:"\u6574\u7406\u5185\u5bb9",refer:"\u53c2\u8003\u8d44\u6599",charTable2:[["\u00b1","\u00d7","\u00f7","\u2236","\u2211","\u220f","\u222a","\u2229","\u2208","\u2237"],["\u221a",
"\u22a5","\u2225","\u2220","\u2312","\u222b","\u222e","\u2261","\u224c","\u2248"],["\u221d","\u2260","\u226e","\u226f","\u2264","\u2265","\u221e","\u2235","\u2234","\u33d1"],["\u33d2"],["\uff04","\uffe0","\uffe1","\u33ce","\u338e","\u338f","\u339c","\u339d","\u339e","\u33a1"],["\u33c4","\u33d5","\u2116"],["\u0101","\u00e1","\u01ce","\u00e0","\u0113","\u00e9","\u011b","\u00e8","\u012b","\u00ed"],["\u01d0","\u00ec","\u014d","\u00f3","\u01d2","\u00f2","\u016b","\u00fa","\u01d4","\u00f9"],["\u01d6","\u01d8",
"\u01da","\u01dc","\u00fc"]],colorTable:[],hdTable:{insertTable:"\u63d2\u5165\u8868\u683c",insertRowUp:"\u5411\u4e0a\u63d2\u5165\u4e00\u884c",insertRowDown:"\u5411\u4e0b\u63d2\u5165\u4e00\u884c",insertColumnLeft:"\u5411\u5de6\u63d2\u5165\u4e00\u5217",insertColumnRight:"\u5411\u53f3\u63d2\u5165\u4e00\u5217",deleteTable:"\u5220\u9664\u8868\u683c",deleteRow:"\u5220\u9664\u884c",deleteColumn:"\u5220\u9664\u5217"},invalidSwf:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740\u3002\n\u53ea\u5141\u8bb8swf\u683c\u5f0f\u3002",
invalidImg:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740\u3002\n\u53ea\u5141\u8bb8jpg,gif,bmp,png\u683c\u5f0f\u3002",invalidMedia:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740\u3002\n\u53ea\u5141\u8bb8mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb\u683c\u5f0f\u3002",invalidWidth:"\u5bbd\u5ea6\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidHeight:"\u9ad8\u5ea6\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidBorder:"\u8fb9\u6846\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidUrl:"URL\u4e0d\u6b63\u786e\u3002",
pleaseInput:"\u8bf7\u8f93\u5165\u5185\u5bb9"};HD.$=function(a,b){return(b||document).getElementById(a)};HD.$$=function(a,b){return(b||document).createElement(a)};HD.event={add:function(a,b,c,d){if(a.addEventListener)a.addEventListener(b,c,d||false);else a.attachEvent&&a.attachEvent("on"+b,c)},remove:function(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else a.detachEvent&&a.detachEvent("on"+b,c)},esc:1};HD.each=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])};
HD.util={filter65279:function(a){for(var b=String.fromCharCode(65279),c=RegExp(b,"g");a.indexOf(b)>-1;)a=a.replace(c,"");return a},cursorToNext:function(a,b){if(HD.browser=="IE")try{b.insertAdjacentHTML("afterEnd",'<a name="temp_ref">&nbsp;</a><a name="temp_ref">&nbsp;</a>');HD.util.selection(a);var c=HD.g[a].idocument;range=c.body.createTextRange();range.moveToElementText(b);range.collapse(false);range.move("character",1);range.select();var d=c.getElementsByName("temp_ref");if(d.length>0){d[0].parentNode.removeChild(d[0]);
d[0].parentNode.removeChild(d[0])}}catch(e){}else{HD.util.selection(a);range=HD.g[a].range;range.setStartAfter(b);range.collapse(true)}},input:function(a){if(!a)return a;return a=a.replace(/\n/g,"").replace(/<.*?>/g,"")},addSubmitIframe:function(){if(!HD.$("hd_iframe_submit")){var a=HD.$$("iframe");a.id="hd_iframe_submit";a.name="hd_iframe_submit";a.style.display="none";document.body.appendChild(a);try{window.frames.hd_iframe_submit.name="hd_iframe_submit"}catch(b){}}},resetSubmitIframe:function(){var a=
HD.$("hd_iframe_submit");a.parentNode.removeChild(a);this.addSubmitIframe()},isHudong:function(){if(typeof g_logout_editor=="string")return false;if(/^http:\/\/(kaiyuan|ibm|internet)\.hudong\.com/i.test(location.href))return false;return/^http:\/\/(\w+\.){1,2}(hudong\.com|baike\.com)/i.test(location.href)},filterIgnore:function(){if(/^http:\/\/(www\.hudong\.com\/navigation\.wiki)/i.test(location.href))return true;return false},isChange:function(a){return HD.g[a].undoStack.length>1},isIE6:function(){var a=
navigator.userAgent;if(/MSIE [78]/.test(a))return false;if(/MSIE [56]/.test(a))return true;return false},isIE:function(){return/MSIE/.test(navigator.userAgent)},strlen:function(a){return a.replace(/[^\x00-\xff]/g,"mm").length},trim:function(a){if(typeof a!="string")return a;return a.replace(/(^\s*)|(\s*$)/g,"")},getDocumentElement:function(){return document.compatMode!="CSS1Compat"?document.body:document.documentElement},getDocumentHeight:function(){var a=this.getDocumentElement();return Math.max(a.scrollHeight,
a.clientHeight)},getDocOffsetWidth:function(){return parseInt(document.getElementsByTagName("body")[0].offsetWidth)},scrollTop:function(a){a=a||document;return a.documentElement.scrollTop||a.body.scrollTop},getDocumentWidth:function(){var a=this.getDocumentElement();return Math.max(a.scrollWidth,a.clientWidth)},getScriptPath:function(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++)if(a[b].src&&a[b].src.match(/hdeditor[\w\-\.]*\.js/)!=null)return a[b].src.substring(0,a[b].src.lastIndexOf("/")+
1)},getHtmlPath:function(){return location.href.substring(0,location.href.lastIndexOf("/")+1)},getBrowser:function(){var a="",b=navigator.userAgent.toLowerCase();if(b.indexOf("msie")>-1)a="IE";else if(b.indexOf("chrome")>-1)a="CHROME";else if(b.indexOf("gecko")>-1)a="GECKO";else if(b.indexOf("opera")>-1)a="OPERA";return a},loadStyle:function(a){var b=HD.$$("link");b.setAttribute("type","text/css");b.setAttribute("rel","stylesheet");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b)},
inArray:function(a,b){for(var c=0;c<b.length;c++)if(a==b[c])return true;return false},escape:function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/ /g,"&nbsp;");a=a.replace(/\xA0/g,"&nbsp;");return a=a.replace(/\x20/g," ")},getElementPos:function(a,b){var c=0,d=0;if(a.getBoundingClientRect){d=a.getBoundingClientRect();b=b||this.getDocumentElement();c=d.left;d=d.top;if(b.scrollLeft)c+=b.scrollLeft;if(b.scrollTop)d+=b.scrollTop;if(b.clientLeft)c-=b.clientLeft;
if(b.clientTop)d-=b.clientTop}else{c=a.offsetLeft;d=a.offsetTop;for(var e=a.offsetParent;e;){c+=e.offsetLeft;d+=e.offsetTop;e=e.offsetParent}}if(/safari/i.test(HD.userAgent))c+=55;return{x:c,y:d}},getCoords:function(a){a=a||window.event;var b=this.getDocumentElement();if(a.pageX)return{x:a.pageX,y:a.pageY};return{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}},setOpacity:function(a,b){if(HD.browser=="IE")try{a.style.filter=b==100?"":"alpha(opacity="+b+")"}catch(c){}else a.style.opacity=
b==100?"":"0."+b.toString()},showBottom:function(a){HD.g[a].bottom.style.display="block"},hideBottom:function(a){HD.g[a].bottom.style.display="none"},drag:function(a,b,c,d){var e=HD.g[a];b.onmousedown=function(f){HD.browser!="IE"&&f.preventDefault();f=HD.util.getCoords(f||window.event);var g=parseInt(c.style.top),h=parseInt(c.style.left),k=parseInt(c.style.width),n=parseInt(c.style.height),q=f.y,s=f.x,r=true,p=function(t){if(r){t=HD.util.getCoords(t||window.event);d(g,h,k,n,t.y-q,t.x-s)}return false},
w=function(){if(e.wyswygMode)e.iframe.style.display="";r=false;HD.event.remove(document,"mousemove",p);HD.event.remove(document,"mouseup",w)};HD.event.add(document,"mousemove",p);HD.event.add(document,"mouseup",w)}},setDefaultPlugin:function(){for(var a=["cut","copy","justifyleft","justifycenter","justifyright"],b=0;b<a.length;b++)HD.plugin[a[b]]={click:new Function("id",'HD.util.execCommand(id, "'+a[b]+'", null);')}},getIframeDoc:function(a){var b=a.contentWindow,c=null;return c=a.contentDocument?
a.contentDocument:b.document},getFullHtml:function(a,b){b=b?HD.util.filterData(b):"";var c="<html>";c+="<head>";c+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />';c+='<meta http-equiv="Content-Language" content="zh-CN" />';c+='<base href="'+HD.htmlPath+'" />';c+="<title>editor</title>";if(HD.g[a].cssPath)c+='<link href="'+HD.g[a].cssPath+'" rel="stylesheet" type="text/css" />';c+="</head>\n<body>\n"+b+"\n</body>\n</html>";return c},gotoTop:function(){window.scrollTo(0,0)},
resize:function(a,b,c){a=HD.g[a];if(c>a.maxHeight)c=a.maxHeight;if(c<=a.minHeight)c=a.minHeight;a.formDiv.style.height=c+"px";b=a.formDiv.offsetHeight-a.formDiv.clientHeight;if(HD.browser=="IE"){var d=a.container.offsetWidth-a.container.clientWidth;if(document.compatMode!="CSS1Compat"){c-=d;a.formDiv.style.height=c+b+"px"}else a.formDiv.style.height=c+"px"}else a.formDiv.style.height=c+"px";a.iframe.style.height=c+"px";this.isIE6()&&HD.util.autoToolbarTop(null,"resize")},autoHeight:function(a){if(!HD.g[a].autoHeight)return 0;
var b=0,c=HD.g[a].idocument,d=c.createElement("DIV");d.style.clear="both";d.style.display="block";c.body.appendChild(d);b=d.offsetTop+20;c.body.removeChild(d);HD.util.resize(a,800,b)},autoToolbarTop:function(a,b){a=a||HD.id;if(!HD.g[a].autoHeight)return 0;if(HD.g[a].toolbarDiv){var c=this.isIE6(),d=HD.util.scrollTop();if(!(d>200&&HD.g[a].toolbarDiv.className=="fixedElement"&&!c&&b=="scroll")){HD.g[a].toolbarDiv.className=HD.g[a].toolbarTop>d?"":"fixedElement";if(HD.$("editor_right")){HD.$("editor_right").style.left=
null;if(!c)if(HD.g[a].toolbarTop>=d){HD.$("editor_right").className="hd-box";HD.$("editor_right").style.top="80px";HD.$("editor_right").style.right="0px"}else{var e=document.documentElement.clientWidth||document.body.clientWidth;HD.$("editor_right").style.top="60px";if(e>1440)HD.$("editor_right").style.right=(e-1440)/2+"px";else if(e>1E3)HD.$("editor_right").style.right="10px";else if(e<969)HD.$("editor_right").style.left="730px";else HD.$("editor_right").style.left=e-240+"px";HD.$("editor_right").className=
"hd-box fixedElement"}}if(c)if(b=="resize"){HD.g[a].toolbarDiv.style.top=d+"px";if(HD.$("editor_right"))if(HD.g[a].toolbarTop>=d){HD.$("editor_right").className="hd-box";HD.$("editor_right").style.top="80px";HD.$("editor_right").style.right="0px"}else{e=document.documentElement.clientWidth||document.body.clientWidth;HD.$("editor_right").style.top=d+60+"px";HD.$("editor_right").className="hd-box fixedElement"}}else{HD.g[a].toolbarDiv.style.display="none";HD.timeout&&clearTimeout(HD.timeout);HD.timeout=
setTimeout(function(){HD.g[a].toolbarDiv.style.top=d+"px";HD.g[a].toolbarDiv.style.display="";if(HD.$("editor_right"))if(HD.g[a].toolbarTop>=d){HD.$("editor_right").className="hd-box";HD.$("editor_right").style.top="80px";HD.$("editor_right").style.right="0px"}else{HD.$("editor_right").style.top=d+60+"px";HD.$("editor_right").className="hd-box fixedElement"}HD.timeout=null},200)}}}},filterData:function(a){a=a.replace(/class=">/ig,">");a=a.replace(/class=""/ig,"");a=a.replace(/class=" ?error"/ig,"");
a=a.replace(/<a([^>]+?)\?>/ig,"<a$1>");a=a.replace(/(<\/?font.*?>)+/ig,"");a=a.replace(/\.hoodong.com\//ig,".baike.com/");a=a.replace(/<(div|strong|span|a|p)[^>]*?> *<\/\1>/ig,"");a=a.replace(/<a[^>]*?>(<\/?strong>)?<\/a>/ig,"$1");a=a.replace(/<strong([^>]*?>.+?)<\/strong>/ig,"<_strong_$1</_strong_>");a=a.replace(/(<\/?strong.*?>)+/ig,"");a=a.replace(/_strong_/ig,"strong");HD.util.isHudong()||(a=a.replace(/http:[^ '"]*?(index\.php\?doc-innerlink-)/ig,"$1"));return a},changeData:function(a,b){b=this.filterData(b);
HD.g[a].idocument.body.innerHTML=b;HD.g[a].newTextarea.value=b;this.checkExternalLink(a);return true},repairInnerLink:function(a){var b=a.innerText||a.textContent,c="";c=a.getElementsByTagName("img");b=HD.util.trim(b);if(!(c.length>0)){if(!b)return a.parentNode.removeChild(a);location.hostname.toLowerCase();if(HD.util.isHudong()){if(!(!/^http:\/\/www\.hudong\.com/i.test(a.href)&&/^http:\/\/(\w+\.){1,2}hudong\.com/i.test(a.href)))if(b.indexOf("http://")==-1&&(a.className=="innerlink"||/\/?wiki\//i.test(a.href)))a.href=
"http://www.baike.com/wiki/"+encodeURI(b)}else if(b.indexOf("http://")==-1&&(a.className=="innerlink"||/innerlink/i.test(a.href)))a.href="index.php?doc-innerlink-"+encodeURI(b)}},clearEmptyTag:function(a){var b,c,d=["STRONG","SPAN","P"];for(j=0;j<d.length;j++){c=HD.g[a].idocument.getElementsByTagName(d[j]);for(i=0;i<c.length;i++)HD.util.trim(c[i].innerHTML)==""&&c[i].parentNode.removeChild(c[i])}c=HD.g[a].idocument.getElementsByTagName("TABLE");d=0;var e;for(i=0;i<c.length;i++){b=true;a=c[i].getElementsByTagName("TD");
for(j=0;j<a.length;j++)if(a[j].innerHTML!=""){b=false;break}if(b){d++;c[i].parentNode.removeChild(c[i])}else{b=c[i].getElementsByTagName("img");e=c[i].innerText||c[i].textContent;e=HD.util.trim(e);b.length==1&&a.length<=2&&e!==null&&e.length<50&&HD.shortcutMenu._img_add_des_div(c[i],b[0])}}},checkExternalLink:function(a){if(!(HD.isCheckExternalLink||HD.util.filterIgnore())){HD.isCheckExternalLink=1;var b=/^http:\/\/(\w+\.){1,2}(hudong|baike)\.com/i;a=a||HD.id;HD.util.scrollTop();var c,d=0,e=location.hostname.toLowerCase(),
f=HD.g[a].idocument.getElementsByTagName("A");for(g=0;g<f.length;g++){c=f[g].href.toLowerCase();if(HD.browser=="IE"&&!f[g].ondragenter)f[g].ondragenter=function(){return false};if(HD.util.trim(f[g].innerHTML)=="")f[g].parentNode.removeChild(f[g]);else if(!HD.util.isHudong()&&HD.g[a].filterExternal&&c.indexOf("http")==0&&c.indexOf(e)==-1&&!b.test(c)||HD.util.isHudong()&&!b.test(f[g].href)){if(f[g].innerHTML.indexOf("<")==-1){c=HD.g[a].idocument.createTextNode(f[g].innerHTML);f[g].parentNode.insertBefore(c,
f[g])}else for(c=f[g].childNodes.length-1;c>=0;c--)f[g].parentNode.insertBefore(f[g].childNodes[c].cloneNode(true),f[g]);f[g].parentNode.removeChild(f[g])}else{if(/<img/i.test(f[g].innerHTML)){c=f[g].getElementsByTagName("img")[0];if(HD.util.isHudong())if(!b.test(c.src)){f[g].parentNode.insertBefore(c.cloneNode(true),f[g]);f[g].parentNode.removeChild(f[g]);continue}}this.repairInnerLink(f[g]);if(HD.g[a].filterExternal)if(HD.util.isHudong())if(b.test(f[g].href))f[g].className=f[g].className.replace(/ *error/i,
"");else if(f[g].href.toLowerCase().indexOf("http:")==-1&&f[g].href.toLowerCase().indexOf("wiki/")>-1)f[g].className=f[g].className.replace(/ *error/i,"");else{if(f[g].className.indexOf("error")==-1)f[g].className+=" error";d++}else if(/^http:/i.test(f[g].href))if(RegExp("http:\\/\\/("+e+"|(\\w+\\.){1,2}hudong\\.com)","i").test(f[g].href))f[g].className=f[g].className.replace(/ *error/i,"");else{if(f[g].className.indexOf("error")==-1)f[g].className+=" error";d++}}}f=HD.g[a].idocument.images;for(var g=
0;g<f.length;g++){el=f[g];if(/^javascript:/i.test(el.src))el.parentNode.removeChild(el);else{el.removeAttribute("width");el.removeAttribute("height");el.removeAttribute("style");if(HD.g[a].filterExternal)if(HD.util.isHudong())if(b.test(el.src)){if(!/_(140|s)\.\w{3}$/i.test(el.src)&&!HD.util.filterIgnore())el.src=el.src.replace(/\.(\w{3})$/i,"_s.$1");el.className=el.className.replace(/ *error/i,"")}else{if(el.className.indexOf("error")==-1)el.className+=" error";d++}else if(HD.g[a].filterExternal)if(/^http:/i.test(el.src))if(RegExp("http:\\/\\/("+
e+"|(\\w+\\.){1,2}(hudong|baike)\\.com)","i").test(el.src))el.className=el.className.replace(/ *error/i,"");else{if(el.className.indexOf("error")==-1)el.className+=" error";d++}if((c=HD.util.getParent(el,"div"))&&/img img_[rl]/i.test(c.className)&&el.width)c.style.width=el.width}}f=HD.g[a].idocument.getElementsByTagName("div");for(g=0;g<f.length;g++){el=f[g];if(/hdwiki_tmml/i.test(el.className))for(c=el.childNodes.length-1;c>=0;c--){a=el.childNodes[c];if(a.nodeType==1){el.parentNode.insertBefore(a.cloneNode(true),
el);a.parentNode.removeChild(a)}}}if(d>0&&HD.$("editor_tip")){HD.$("editor_tip").style.display="";HD.$("editor_tip").innerHTML='\u63d0\u793a\uff1a<br /><font color="red">\u5185\u5bb9\u542b\u6709\u5916\u90e8\u94fe\u63a5\uff0c\u5df2\u88ab\u7ea2\u8272\u4e0b\u5212\u7ebf\u6807\u8bb0\uff0c\u4fdd\u5b58\u540e\u5916\u94fe\u5c06\u88ab\u8fc7\u6ee4\u3002</font>'}else if(d==0&&HD.$("editor_tip")){HD.$("editor_tip").style.display="none";HD.$("editor_tip").innerHTML=""}HD.isCheckExternalLink=0}},filterExternalLink:function(a,
b){var c=/^http:\/\/(\w+\.){1,2}(hudong|baike)\.com/i;a=a||HD.id;if(!HD.g[a].filterExternal||HD.util.filterIgnore())return b;var d=/<a[^>]*?>(.*?)<\/a>/ig,e=/href=['"]?([^'" ]+)['"]?/i,f=/href=['"]?\.+\/wiki\/([^'" ]+)['"]?/i,g,h,k=b.match(d),n=location.hostname.toLowerCase();if(k)for(i=0;i<k.length;i++){g=k[i];if((h=g.match(e))&&h.length==2){h=h[1];if(HD.util.isHudong())if(h.indexOf("http://")>-1)c.test(h)||(b=b.replace(g,g.replace(d,"$1")));else{if(f.test(g))b=b.replace(g,g.replace(f,'href="http://www.baike.com/wiki/$1"'))}else if(/^http:/i.test(h))RegExp("http:\\/\\/("+
n+"|(\\w+\\.){1,2}(hudong|baike)\\.com)","i").test(h)||(b=b.replace(g,g.replace(d,"$1")))}}d=/<img[^>]*?>/ig;e=/src=['"]?([^'" ]+)['"]?/i;k=b.match(d);d="";if(k)for(i=0;i<k.length;i++){g=k[i];if((h=g.match(e))&&h.length==2){d=h[1];if(HD.util.isHudong())c.test(d)||(b=b.replace(g,""));else if(/^http:/i.test(d)&&HD.g[a].filterExternal){if(d.indexOf(n)==-1&&!c.test(d))b=b.replace(g,"")}else if(/^javascript:/i.test(d))b=b.replace(g,"")}}return b},getData:function(a,b){var c;a=a||HD.id;b=typeof b=="undefined"?
true:b;if(HD.g[a].wyswygMode)if(b){HD.plugin.refer&&HD.plugin.refer.order_on_submit();c=HD.g[a].isClean?HD.g[a].idocument.body.innerHTML:this.domFilter(a);c=this.filterExternalLink(a,c);c=this.filterData(c)}else c=HD.g[a].idocument.body.innerHTML;else c=HD.g[a].newTextarea.value;if(c!=""&&c.length<1E3)if(HD.util.trim(c.replace(/<.*?>/gi,""))=="")c="";HD.util.isHudong()||(c=c.replace(/http:[^ '"]+?\/uploads/gi,"uploads"));return c},setData:function(a){var b=this.getData(a,HD.g[a].filterMode);HD.g[a].srcTextarea.value=
b},getPureData:function(a){a=this.getData(a,false);a=a.replace(/<br[\s\/]{0,2}>/ig,"\r\n");return a=a.replace(/<.*?>/ig,"")},setPureData:function(a){var b=this.getPureData(a);HD.g[a].srcTextarea.value=b},focus:function(a){HD.g[a].wyswygMode?HD.g[a].iframeWin.focus():HD.g[a].newTextarea.focus()},click:function(a,b){HD.util.selection(a);HD.layout.hide(a);HD.util.focus(a);if(b=="paste")b="dopaste";HD.plugin[b].click(a)},selection:function(a){var b=HD.g[a].iframeWin,c=HD.g[a].idocument;b=b.getSelection?
b.getSelection():c.selection;var d;try{d=b.rangeCount>0?b.getRangeAt(0):b.createRange?b.createRange():c.createRange()}catch(e){}d||(d=HD.browser=="IE"?c.body.createTextRange():c.createRange());HD.g[a].selection=b;HD.g[a].range=d},select:function(a){if(HD.browser=="IE"&&HD.g[a].range)try{HD.g[a].range.select()}catch(b){}},getParentElement:function(a){HD.util.selection(a);var b=HD.g[a].range;if(HD.browser=="IE")switch(HD.g[a].selection.type){case "Text":case "None":return b.parentElement();case "Control":return b.item(0);
default:return HD.g[a].idocument.body}else try{var c=b.commonAncestorContainer;if(!b.collapsed&&b.startContainer==b.endContainer&&b.startOffset-b.endOffset<=1&&b.startContainer.hasChildNodes())c=b.startContainer.childNodes[b.startOffset];for(;c.nodeType==3;)c=c.parentNode;return c}catch(d){return null}},moveToAncestorNode:function(a,b){HD.util.select(a);for(var c=HD.util.getParentElement(a);c;){if(b==c.nodeName)break;c=c.parentNode}return c},getParent:function(a,b){for(var c=a.parentNode;c&&c.nodeName!=
"BODY";){if(c.nodeName.toUpperCase()==b.toUpperCase())break;c=c.parentNode}return c.nodeName.toUpperCase()==b.toUpperCase()?c:null},getSelectedText:function(a,b){var c;HD.util.selection(a);b=b=="htmlText"||b=="html"?"htmlText":"text";if(HD.browser=="IE")c=HD.g[a].range[b];else if(b=="text")c=HD.g[a].range.toString();else{c=HD.$$("div");c.appendChild(HD.g[a].range.cloneContents());c=c.innerHTML}return c},editorEvent:function(a,b){if(a.keyCode==13){var c=HD.util.getParentElement(b);if(c.nodeName=="DIV"&&
c.className.indexOf("hdwiki_tmml")>-1||c.nodeName=="A"){var d=HD.$$("br",HD.g[b].idocument);HD.clientX&&HD.clientX<20?c.parentNode.insertBefore(d,c):c.parentNode.insertBefore(d,c.nextSibling);if(HD.browser=="IE"){HD.iframeClickTag="";a.returnValue=false}else a.preventDefault();HD.shortcutMenu.hide();return false}}if(a.ctrlKey&&!a.altKey){c=null;switch(String.fromCharCode(a.keyCode||a.charCode||a.which).toLowerCase()){case "a":HD.toolbar.disable(b,["save","preview","cut","copy","source"]);HD.iframeClickTag=
"";break;case "b":c="bold";break;case "i":c="italic";break;case "u":c="underline";break;case "l":c="justifyleft";break;case "e":c="justifycenter";break;case "r":c="justifyright";break;case "z":c="undo";break;case "y":c="redo";break;case "q":c="innerlink";break;case "x":HD.shortcutMenu.hide();break;case "w":case "1":c="title1";break;case "2":c="title2"}if(c){if(HD.browser=="IE"){a.cancelBubble=true;a.returnValue=false}else{a.preventDefault();a.stopPropagation()}HD.plugin[c]?HD.plugin[c].click(b):HD.util.execCommand(b,
c,null)}}},execCommand:function(a,b,c){try{var d=this.getSelectedText(a,"html");if(d&&b=="bold")if(/<h3>|<div\s+class=\"?hdwiki_tmm/i.test(d)){this.showTip(a,"\u8bf7\u4e0d\u8981\u9009\u4e2d\u4e00\u7ea7\u6807\u9898\u6216\u4e8c\u7ea7\u6807\u9898\uff01");return false}HD.g[a].idocument.execCommand(b,false,c);var e=HD.g[a].toolbarIcon[b];if(e)e.className=e.className.replace(/ *hd-icon-selected/i,"")}catch(f){var g;switch(b){case "cut":g="Ctrl + X";break;case "copy":g="Ctrl + C";break;case "paste":g="Ctrl + V"}g&&
alert("\u6b64\u529f\u80fd\u5728IE\u6d4f\u89c8\u5668\u4e0b\u624d\u53ef\u4ee5\u6267\u884c\uff0c\u63a8\u8350\u60a8\u4f7f\u7528\u5bf9\u5e94\u7684\u5feb\u6377\u952e:"+g+"\u3002");return false}HD.history.add(a,false);HD.layout.hide(a);HD.util.focus(a)},insertHtml:function(a,b){if(b!=""){HD.util.select(a);if(HD.browser=="IE")if(HD.g[a].selection.type.toLowerCase()=="control")HD.g[a].range.item(0).outerHTML=b;else HD.g[a].range.pasteHTML(b);else this.execCommand(a,"inserthtml",b);HD.history.add(a,false)}},
removeDomain:function(a,b){for(var c=HD.g[a].siteDomains,d=0,e=c.length;d<e;d++){var f="http://"+c[d];if(b.indexOf(f)==0)return b.substr(f.length)}return b},domFilter:function(a,b){HD.g[a].domFilterResult="";b=b||HD.g[a].htmlTags;var c=0,d=0,e=0,f=0,g=0,h=0,k=["onclick","onmouseout","onmouseover","onmousemove","align","color","font","height","vspace","hspace","id","class","style","left","right","name","rel","size","title","width","valign","bgcolor","dir"],n=function(q){q=q.childNodes;for(var s=0;s<
q.length;s++){var r=q[s];if(1==r.nodeType){var p=r.tagName.toLowerCase();if(b[p]){var w=HD.browser=="IE"?k:r.attributes,t=r.style;if(HD.browser=="IE"&&t.cssText){var v=[];t=t.cssText.replace(/ /g,"").split(";");for(var u=0;u<t.length;u++)v.push(t[u].split(":")[0]);t=v}p=b[p];for(u=0;u<w.length;u++){v=HD.browser=="IE"?w[u]:w[u].name.toLowerCase();c++;if(!HD.util.inArray(v,p)){r.removeAttribute(v);f++;r.getAttribute(v)}}for(u=0;u<t.length;u++){v=t[u];d++;if(!HD.util.inArray("."+v.toLowerCase(),p))if(HD.browser==
"IE"){g++;r.style.cssText=r.style.cssText.replace(RegExp(v+": \\w+","gi"),"")}else{g++;r.style[v]=""}}r.hasChildNodes()&&n(r)}else{if(r.hasChildNodes())for(u=0;u<r.childNodes.length;u++){n(r.childNodes[u]);r.parentNode.insertBefore(r.childNodes[u].cloneNode(true),r)}r.parentNode.removeChild(r);h++;e++}}}};n(HD.g[a].idocument.body);HD.g[a].domFilterResult="\u8fc7\u6ee4\u6389"+h+"\u4e2a\u8282\u70b9\uff0c"+f+"\u4e2a\u5c5e\u6027\uff0c"+g+"\u4e2a\u6837\u5f0f\u3002";return HD.g[a].idocument.body.innerHTML},
showTip:function(a,b,c,d){(new HD.dialog2({id:a,content:'<li><div style="width:300px">'+b+"</div></li>",width:350,height:d>0?d:200,title:"\u63d0\u793a",noButton:HD.lang.close,notFocus:c})).show();return true},showInput:function(a,b,c,d,e){var f="\u63d2\u5165"+HD.lang[b];e=e||100;if(f.indexOf(" ">0))f=f.split(" ")[0];var g="";if(d)g+='<li><div style="width:300px">'+d+"</div></li>";g+='<li><input id="hd_input_'+b+'" style="width:98%;border: 1px solid #AAAAAA;padding:3px;" maxlength="'+e+'" /></li>';
(new HD.dialog2({id:a,cmd:b,content:g,width:350,height:c>0?c:200,title:f,yesButton:HD.lang.yes,noButton:HD.lang.close})).show();HD.iframeClickTag="";return true},uploading:function(a,b){html='<li><div id="hd_dialog_tip" class="hd_img_uploading">'+(b||"\u6b63\u5728\u4fdd\u5b58...")+"</div></li>";(new HD.dialog2({id:a,content:html,width:350,height:200,title:"\u63d0\u793a",close:false})).show();return true},autoCloseTip:function(a,b,c){c=c||1;HD.util.uploading(a,b);setTimeout(function(){HD.layout.hide(a)},
c*1E3)},isAtImg:function(a){var b=false,c,d,e=0,f=0,g=0;e=a=HD.util.getParentElement(a);if(a.nodeName=="TD")for(;e&&e.nodeName!="BODY";){if(e.nodeName=="TABLE"){c=e;break}e=e.parentNode}else for(;e&&e.nodeName!="BODY";){if(e.nodeName=="TD")a=e;else if(e.nodeName=="TABLE"){c=e;break}e=e.parentNode}if(c){e=c.getElementsByTagName("TR").length;f=c.getElementsByTagName("TD").length;g=c.getElementsByTagName("IMG").length;if(e==2&&f==2&&g==1)b=true}else{e=a;if(a.nodeName=="DIV")d=a;else for(;e&&e.nodeName!=
"BODY";){if(e.nodeName=="DIV"){d=e;break}e=e.parentNode}if(d&&/img_[lr]/i.test(d.className)){g=d.getElementsByTagName("IMG").length;if(g==1)b=true}}return b}};
HD.layout={show:function(a,b){HD.util.selection(a);HD.layout.hide(a);HD.g[a].hideDiv.appendChild(b);HD.g[a].hideDiv.style.display="block";HD.g[a].layoutDiv=b},hide:function(a,b){if(b){if(/scroll/i.test(b.type))if(HD.g[a].layoutDiv&&/dialog/i.test(HD.g[a].layoutDiv.className))return false;var c=b.target||b.srcElement;if(c&&/hd-common-icon/i.test(c.className))return false;if(c&&/dialog|hd-mask/i.test(c.className))return false;if(c&&/refrence_edita/i.test(c.className))return false;for(;c&&c.nodeName!=
"BODY";){if((c=c.parentNode)&&/dialog|hd-menu|hd-toolbar-table/i.test(c.className))return false;if(c&&/pushbutton/i.test(c.className))return false}}try{var d=HD.g[a].hideDiv.childNodes;for(i=0;i<d.length;i++)HD.g[a].hideDiv.removeChild(d[i])}catch(e){}HD.g[a].hideDiv.style.display="none";HD.g[a].maskDiv.style.display="none";HD.plugin.table&&HD.plugin.table.hide(a);if(HD.imageUploading==1){HD.util.resetSubmitIframe();HD.imageUploading=0}},make:function(){var a=HD.$$("div");a.style.position="absolute";
a.style.zIndex=10020;return a}};
HD.menu=function(a){this.arg=a;var b=HD.g[a.id].layoutDiv;if(b)if(b.cmd==a.cmd){HD.g[a.id].layoutDiv=null;return false}b=HD.layout.make(a.id);b.className="hd-menu";b.cmd=a.cmd;if(this.arg.width)b.style.width=this.arg.width;var c=HD.g[a.id].toolbarIcon[a.cmd],d=HD.util.getElementPos(c),e=document.documentElement.clientWidth||document.body.clientWidth,f=document.getElementsByTagName("body")[0];f=parseInt(f.offsetWidth);d.x-=e>1440?(e-f)/2:10;if(a.cmd=="fontstyle"||a.cmd=="justifymore")d.x-=23;b.style.top=
d.y+c.offsetHeight+"px";b.style.left=d.x+"px";this.ul=HD.$$("ul");b.appendChild(this.ul);this.div=b;this.add=function(g,h,k){var n=HD.$$("li");if(k)n.className="hd-menu-disabled";else{n.className="hd-menu-noselected";n.onmouseover=function(){var q=n.parentNode.childNodes;for(i in q)if(q[i].className!="hd-menu-disabled")q[i].className="hd-menu-noselected";this.className="hd-menu-selected"};n.onmouseout=function(){if(this.className!="hd-menu-disabled")this.className="hd-menu-noselected"};n.onclick=
function(){h();HD.g[a.id].layoutDiv=null}}n.innerHTML=g;this.append(n)};this.append=function(g){this.ul.appendChild(g)};this.insert=function(g){this.div.innerHTML=g};this.show=function(){HD.layout.show(this.arg.id,this.div)};this.picker=function(){this.div.style.width="200px";var g=HD.lang.colorTable,h=HD.$$("table");h.className="hd-picker-color";h.cellPadding=0;h.cellSpacing=0;h.border=0;h.style.margin=0;h.style.padding=0;h.style.borderCollapse="separate";for(var k=0;k<g.length;k++)for(var n=h.insertRow(k),
q=0;q<g[k].length;q++){var s=n.insertCell(q);s.style.backgroundColor=g[k][q];s.title=g[k][q];s.onmouseover=function(){this.style.borderColor="#000000"};s.onmouseout=function(){this.style.borderColor="#F0F0EE"};s.onclick=new Function('HD.plugin["'+this.arg.cmd+'"].exec("'+this.arg.id+'", "'+g[k][q]+'")');s.innerHTML="&nbsp;"}this.append(h);this.show()}};
HD.dialog2=function(a){a.id=a.id||HD.id;this.arg=a;this.getPos=function(){var b=this.arg,c=this.arg.id,d=HD.util.getElementPos(HD.g[c].container),e=b.height;b=Math.round(parseInt(HD.g[c].container.offsetWidth)/2)-Math.round(b.width/2);d=b<0?d.x:d.x+b;b=document.documentElement.clientWidth||document.body.clientWidth;c=parseInt(document.getElementsByTagName("body")[0].offsetWidth);d-=(b-c)/2;return{x:d,y:(document.body.scrollTop||document.documentElement.scrollTop)+((document.documentElement.clientHeight||
window.screen.availHeight)-e)/2-30}};this.show=function(){var b=this.arg,c=b.id,d=HD.layout.make(b.id);d.id="hd-dialog";d.className="hd-dialog";var e=this.getPos();d.style.width=b.width+"px";var f=document.documentElement.clientWidth||document.body.clientWidth;if(f>1440)e.x-=(f-1440)/2;d.style.top=e.y+"px";d.style.left=e.x+"px";e=HD.$$("h2");e.innerHTML=b.title;d.appendChild(e);if(b.close!==false){e=HD.$$("img");e.src=HD.g[c].skinsPath+"spacer.gif";e.className="close";e.alt=HD.lang.close;e.title=
HD.lang.close;e.onclick=function(){HD.util.focus(c);HD.util.select(c);HD.layout.hide(c)};d.appendChild(e)}e=HD.$$("form");e.setAttribute("target","hd_iframe_submit");e.setAttribute("method","post");e.setAttribute("action",b.action||"");e.onsubmit=new Function("return HD.plugin['"+b.cmd+"'].exec('"+c+"');");if(HD.browser=="CHROME"||/(Firefox\/[456789]|Gecko)/i.test(navigator.userAgent))e.setAttribute("enctype","multipart/form-data");else e.encoding?e.setAttribute("encoding","multipart/form-data"):
e.setAttribute("enctype","multipart/form-data");if(b.content.substr(0,3)=="<li"){f=HD.$$("ul");f.innerHTML=b.content;if(b.cmd!="source"&&b.cmd!="dopaste"&&b.cmd!="wordpaste")f.style.width="300px";e.appendChild(f)}else e.innerHTML=b.content;d.appendChild(e);f=HD.$$("p");f.className="pushbutton a-c pad-b-10";var g=null,h=null;if(b.yesButton){h=HD.$$("input");h.className="conserve";h.type="button";h.name="yesButton";h.id="yesButton";h.value=b.yesButton;h.onclick=new Function("HD.plugin['"+b.cmd+"'].exec('"+
c+"');");f.appendChild(h)}if(b.noButton){g=HD.$$("input");g.type="button";g.name="noButton";g.id="noButton";g.value=b.noButton;g.onclick=function(){if(!b.notFocus){HD.util.focus(c);HD.util.select(c)}HD.layout.hide(c)};f.appendChild(g)}if(!b.yesButton&&!b.noButton){f=HD.$$("div");f.innerHTML="&nbsp;"}d.appendChild(f);HD.layout.show(c,d);window.focus();d.focus();document.documentElement&&document.documentElement.clientHeight>500&&b.noButton&&g.focus();HD.$("hd_input_"+b.cmd)&&HD.$("hd_input_"+b.cmd).focus();
HD.g[c].maskDiv.style.height=HD.util.getDocumentHeight()+"px";HD.g[c].maskDiv.style.display="block";HD.g[c].noButton=g;HD.g[c].yesButton=h;HD.g[c].form=e};this.show2=function(){var b=this.arg,c=b.id,d=HD.layout.make(b.id);d.id="hd-dialog";d.className="hd-dialog2";var e=this.getPos();d.style.width=b.width+"px";var f=document.documentElement.clientWidth||document.body.clientWidth;if(f>1440)e.x-=(f-1440)/2;d.style.top=e.y+"px";d.style.left=e.x+"px";e=HD.$$("h2");e.innerHTML=b.title;d.appendChild(e);
if(b.close!==false){e=HD.$$("img");e.src=HD.g[c].skinsPath+"spacer.gif";e.className="close";e.alt=HD.lang.close;e.title=HD.lang.close;e.onclick=function(){HD.util.focus(c);HD.util.select(c);HD.layout.hide(c);if(HD.plugin.refer)HD.plugin.refer.edit_name=""};d.appendChild(e)}e=HD.$$("div");e.id="hd-dialog-ref";e.className="postil";e.innerHTML=b.content;d.appendChild(e);e=HD.$$("p");e.className="pushbutton a-c pad-b-10";var g=f=null;if(b.yesButton){g=HD.$$("input");g.className="conserve";g.type="button";
g.name="yesButton";g.id="yesButton";g.value=b.yesButton;g.onclick=new Function("HD.plugin['"+b.cmd+"'].exec('"+c+"');");e.appendChild(g)}if(b.noButton){f=HD.$$("input");f.type="button";f.name="noButton";f.id="noButton";f.value=b.noButton;f.onclick=function(){if(!b.notFocus){HD.util.focus(c);HD.util.select(c)}HD.layout.hide(c);if(HD.plugin.refer)HD.plugin.refer.edit_name=""};e.appendChild(f)}if(!b.yesButton&&!b.noButton){e=HD.$$("div");e.innerHTML="&nbsp;"}d.appendChild(e);HD.layout.show(c,d);window.focus();
d.focus();document.documentElement&&document.documentElement.clientHeight>500&&b.noButton&&f.focus();HD.$("hd_input_"+b.cmd)&&HD.$("hd_input_"+b.cmd).focus();HD.g[c].maskDiv.style.height=HD.util.getDocumentHeight()+"px";HD.g[c].maskDiv.style.display="block";HD.g[c].noButton=f;HD.g[c].yesButton=g}};
HD.toolbar={enable_one:function(a,b){if(b=="redo"&&HD.g[a].redoStack.length==0)return false;if(b=="undo"&&HD.g[a].undoStack.length<2)return false;var c=HD.g[a].toolbarIcon[b];if(c){c.className="hd-icon";HD.util.setOpacity(c,100);c.onmouseover=function(){this.className+=" cursor"};c.onmouseout=function(){this.className=this.className.replace(/ *cursor/i,"")};c.onclick=new Function('HD.util.click("'+a+'", "'+b+'")')}},disable_one:function(a,b){if(b=="redo"&&HD.g[a].redoStack.length==1)return false;
if(b=="undo"&&HD.g[a].undoStack.length>1)return false;var c=HD.g[a].toolbarIcon[b];if(c){c.className="hd-icon-disabled";HD.util.setOpacity(c,50);c.onmouseover=null;c.onmouseout=null;c.onclick=null}},able:function(a,b){HD.each(HD.g[a].toolbarIcon,function(c){HD.util.inArray(c,b)||HD.toolbar.enable_one(a,c)})},disable:function(a,b){HD.each(HD.g[a].toolbarIcon,function(c){HD.util.inArray(c,b)||HD.toolbar.disable_one(a,c)})},create:function(a){HD.g[a].toolbarIcon=[];var b=HD.$$("table");b.oncontextmenu=
function(){return false};b.onmousedown=function(){return false};b.onmousemove=function(){return false};b.className="hd-toolbar-table l";b.cellPadding=0;b.cellSpacing=0;b.border=0;for(var c=b.insertRow(0),d=HD.g[a].items.length,e=0;e<d;e++){var f=HD.g[a].items[e];if(f!="-"){var g=c.insertCell(e),h=HD.$$("img");h.src=HD.g[a].skinsPath+"spacer.gif";h.className="hd-icon-"+f;h.alt=HD.lang[f];var k=HD.$$("div");k.onmouseover=function(){this.className+=" cursor"};k.onmouseout=function(){this.className=this.className.replace(/ *cursor/i,
"")};k.appendChild(h);k.onclick=new Function('HD.util.click("'+a+'", "'+f+'")');if(f=="bold"&&HD.util.inArray("fontstyle",HD.g[a].items))k.style.marginRight="0px";if(f=="justifyleft"&&HD.util.inArray("justifymore",HD.g[a].items))k.style.marginRight="0px";if(f=="fontstyle"||f=="justifymore"){k.style.marginLeft="0px";k.style.width="12px";k.style.borderLeft="0"}if(f=="save"){k.style.width="40px";k.innerHTML='<span class="hd-icon-save">\u4fdd \u5b58</span>'}if(f=="preview"){k.style.width="40px";k.innerHTML=
'<span class="hd-icon-preview">\u9884 \u89c8</span>'}if(f=="source"){k.style.width="45px";k.innerHTML='<span class="hd-icon-source">\u6e90\u4ee3\u7801</span>'}g.title=HD.lang[f];g.appendChild(k);HD.g[a].toolbarIcon[f]=k}}return b}};
HD.history={add:function(a,b){var c=HD.g[a],d=HD.util.getData(a,false);if(c.undoStack.length>0){var e=c.undoStack[c.undoStack.length-1];if(d==e)return true;if(b&&Math.abs(d.length-e.length)<c.minChangeSize)return true}c.undoStack.push(d);c.redoStack=[];HD.toolbar.disable_one(a,"redo");if(c.undoStack.length>1){HD.toolbar.enable_one(a,"undo");UnloadConfirm.set()}},undo:function(a){var b=HD.g[a];if(b.undoStack.length==0)HD.toolbar.disable_one(a,"undo");else{var c=HD.util.getData(a,false);b.redoStack.push(c);
HD.toolbar.enable_one(a,"redo");var d=b.undoStack.pop();if(c==d&&b.undoStack.length>0)d=b.undoStack.pop();HD.g[a].idocument.body.innerHTML=d;b.newTextarea.value=d}},redo:function(a){var b=HD.g[a];if(b.redoStack.length==0)HD.toolbar.disable_one(a,"redo");else{var c=HD.util.getData(a,false);b.undoStack.push(c);HD.toolbar.enable_one(a,"undo");c=b.redoStack.pop();HD.g[a].idocument.body.innerHTML=c;b.newTextarea.value=c}}};
HD.remove=function(a,b){var c=HD.g[a].container;(typeof b=="undefined"?0:b)==1?document.body.removeChild(c):HD.$(a).parentNode.removeChild(c);document.body.removeChild(HD.g[a].hideDiv);document.body.removeChild(HD.g[a].maskDiv);HD.g[a].containner=null};
HD.shortcutMenu={id:null,element:null,talbe:null,init:function(a){this.id=a;var b=HD.$$("div");b.innerHTML='<div class="shortcut" id="shortcut_a" style="display:none"><span><a id="shortcut_a_goto" target="_blank">\u6253\u5f00\u94fe\u63a5</a></span><span><a id="shortcut_a_unlink">\u53d6\u6d88\u94fe\u63a5</a></span></div><div class="shortcut" id="shortcut_img" style="display:none"><span>\u4f4d\u7f6e\uff1a<a id="shortcut_img_left" title="\u5de6\u5bf9\u9f50">\u5de6\u5bf9\u9f50</a></span><span><a  id="shortcut_img_right" title="\u53f3\u5bf9\u9f50">\u53f3\u5bf9\u9f50</a></span>|<span>\u5c3a\u5bf8\uff1a<a id="shortcut_img_s" title="\u957f\u8fb9'+(typeof g_img_big==
"undefined"?"300":g_img_big)+'\u50cf\u7d20">\u5927\u56fe</a></span><span><a id="shortcut_img_140" title="\u957f\u8fb9'+(typeof g_img_small=="undefined"?"140":g_img_small)+'\u50cf\u7d20">\u5c0f\u56fe</a></span><span id="shortcut_img_des">| <a title="\u70b9\u51fb\u540e\u5728\u5149\u6807\u5904\u8f93\u5165\u6587\u672c">\u6dfb\u52a0\u63cf\u8ff0</a></span>|<span><a id="shortcut_img_remove" title="\u5220\u9664\u56fe\u7247">\u5220\u9664</a></span></div><div class="shortcut" id="shortcut_h" style="display:none"><span><a id="shortcut_h_cancel">\u53d6\u6d88\u76ee\u5f55</a></span><span><a id="shortcut_h_remove" title="\u5220\u9664\u76ee\u5f55">\u5220\u9664</a></span></div><div class="shortcut" id="shortcut_ref" style="display:none"><span><a id="shortcut_ref_edit">\u7f16\u8f91</a></span><span><a id="shortcut_ref_remove">\u5220\u9664</a></span></div>';
document.body.appendChild(b);setTimeout('HD.shortcutMenu.bind_event("'+a+'")',2)},hide:function(){HD.$("shortcut_a").style.display="none";HD.$("shortcut_img").style.display="none";HD.$("shortcut_h").style.display="none";HD.$("shortcut_ref").style.display="none"},show:function(a,b,c){HD.shortcutMenu.hide();a=a||this.id;b=b||this.element;this.table=null;this.id=a;this.element=b;HD.util.selection(a);var d=b.nodeName;if(d!="BODY"){if(d=="A"&&b.getElementsByTagName("img").length>0){this.element=b=b.getElementsByTagName("img")[0];
d="IMG"}var e=HD.util.getElementPos(b,HD.g[a].idocument),f=HD.util.getElementPos(HD.g[a].iframe),g=b.offsetHeight,h=f.y+e.y+g;f=f.x+e.x;var k=document.documentElement.clientWidth||document.body.clientWidth,n=HD.util.getDocOffsetWidth();if(k>1440)f-=(k-n)/2;k=b;if(d=="STRONG"||d=="B"||d=="EM"||d=="I"||d=="U")for(;k&&k.nodeName!="BODY";){if(k.nodeName=="A"){d="A";this.element=b=k;break}k=k.parentNode}switch(d){case "A":HD.$("shortcut_a").style.top=h+"px";HD.$("shortcut_a").style.left=f+"px";HD.$("shortcut_a").style.display=
"block";HD.$("shortcut_a_goto").href=b.href;if(HD.browser=="IE")HD.$("shortcut_a_goto").onclick=function(){window.open(this.href)};break;case "IMG":HD.$("shortcut_img").style.top=h-g-28+"px";HD.$("shortcut_img").style.left=f+"px";HD.$("shortcut_img").style.display="block";this.img_checked();break;case "DIV":if(c.clientX)HD.clientX=c.clientX;if(!/hdwiki_tmm/i.test(b.className)||c.clientY>e.y+g)return false;HD.$("shortcut_h").style.top=h+"px";HD.$("shortcut_h").style.left=f+"px";HD.$("shortcut_h").style.display=
"block";break;case "H3":HD.$("shortcut_h").style.top=h+"px";HD.$("shortcut_h").style.left=f+"px";HD.$("shortcut_h").style.display="block";break;case "SUP":if(/refer/i.test(b.className)&&HD.plugin.refer){HD.$("shortcut_ref").style.top=h+"px";HD.$("shortcut_ref").style.left=f+"px";HD.$("shortcut_ref").style.display="block"}break;default:this.hide()}c=[];if(d=="DIV"&&b.className=="hdwiki_tmml"){HD.toolbar.disable(a,["save","preview","cut","copy","source","title1"]);c.push("title1")}else if(d=="DIV"&&
b.className=="hdwiki_tmmll"){HD.toolbar.disable(a,["save","preview","cut","copy","source","title2"]);c.push("title2")}else if(d=="A"){HD.toolbar.disable(a,["save","preview","cut","copy","source","bold","fontstyle","innerlink"]);c.push("innerlink");/(<b>|<strong>)/i.test(b.innerHTML)&&c.push("bold")}else if(d=="IMG"){HD.toolbar.disable(a,["save","preview","cut","copy","source","image"]);c.push("image")}else if(d=="B"||d=="STRONG")c.push("bold");else if(d=="SPAN")/bold/i.test(b.style.fontWeight)&&c.push("bold");
else if(d=="H3"){HD.toolbar.disable(a,["save","preview","cut","copy","source","title2"]);c.push("title2")}else if(d=="SUP"||d=="SUB")HD.toolbar.disable(a,["save","preview","cut","copy","source","specialchar","fontstyle","bold","refer"]);for(;b&&b.nodeName!="BODY";){if(b.nodeName=="TD"){HD.toolbar.disable(a,["save","preview","cut","copy","paste","bold","fontstyle","justifyleft","justifymore","innerlink","image","media","table","specialchar","source","refer"]);c.push("table");HD.iframeClickTag="";break}b=
b.parentNode}for(i in c)if(HD.g[a].toolbarIcon[c[i]])HD.g[a].toolbarIcon[c[i]].className="hd-icon-selected";return false}},bind_event:function(a){HD.event.add(HD.g[a].idocument,"mouseup",function(){HD.shortcutMenu.img_reset()});HD.event.add(HD.$("shortcut_a_unlink"),"click",function(){HD.shortcutMenu.a_unlink()});HD.event.add(HD.$("shortcut_h_cancel"),"click",function(){HD.shortcutMenu.to_text()});HD.event.add(HD.$("shortcut_h_remove"),"click",function(){HD.shortcutMenu.remove()});HD.event.add(HD.$("shortcut_img_remove"),
"click",function(){HD.shortcutMenu.remove()});HD.event.add(HD.$("shortcut_img_left"),"click",function(){HD.shortcutMenu.img_align("left")});HD.event.add(HD.$("shortcut_img_right"),"click",function(){HD.shortcutMenu.img_align("right")});HD.event.add(HD.$("shortcut_img_s"),"click",function(){HD.shortcutMenu.img_size("s")});HD.event.add(HD.$("shortcut_img_140"),"click",function(){HD.shortcutMenu.img_size("140")});HD.event.add(HD.$("shortcut_img_des"),"click",function(){HD.shortcutMenu.img_add_des_div()});
HD.event.add(HD.$("shortcut_ref_edit"),"click",function(){HD.shortcutMenu.ref_edit()});HD.event.add(HD.$("shortcut_ref_remove"),"click",function(){HD.shortcutMenu.ref_remove()})},to_text:function(a,b){var c=this.id||HD.id;b=b||this.element;HD.history.add(c,false);a=a||b.text||b.innerText||b.innerHTML;if(HD.browser=="IE"||HD.browser=="OPERA"||HD.browser=="CHROME")b.outerHTML=a;else try{b.parentNode.removeChild(b);HD.util.selection(c);HD.util.insertHtml(c,a)}catch(d){}HD.shortcutMenu.hide()},a_unlink:function(){var a=
HD.g[this.id||HD.id].toolbarIcon.innerlink;a.className=a.className.replace(/ *hd-icon-selected/i,"");this.to_text(this.element.innerHTML)},remove:function(){var a=this.id,b=this.table,c=this.element;if(b)var d=b.getElementsByTagName("td").length,e=b.getElementsByTagName("img").length;try{b&&d<=2&&e==1?b.parentNode.removeChild(b):c.parentNode.removeChild(c);HD.history.add(a,false)}catch(f){}HD.shortcutMenu.hide()},img_align:function(a){var b=this.table||this.element;if(b.nodeName=="A"||b.nodeName==
"TABLE")b.align=a;else if(b.nodeName=="DIV")b.className=a=="left"?"img img_l":"img img_r";else if(b.nodeName=="IMG")b.align=a;if(a=="left"){HD.$("shortcut_img_left").className="checked";HD.$("shortcut_img_right").className=""}else{HD.$("shortcut_img_left").className="";HD.$("shortcut_img_right").className="checked"}this.show()},img_size:function(a){var b=this.element.src,c,d=new Image;if(!(a=="s"&&b.indexOf("_s.")>-1||a=="140"&&b.indexOf("_140.")>-1)){c=a=="s"?b.replace("_140.","_s."):b.replace("_s.",
"_140.");d.onload=function(){if(HD.shortcutMenu.table&&HD.shortcutMenu.table.tagName=="DIV")HD.shortcutMenu.table.style.width=this.width;if(a=="s"){HD.shortcutMenu.element.src=b.indexOf("_140.")>-1?b.replace("_140.","_s."):b.replace(/\.(\w{3})$/i,"_s.$1");HD.$("shortcut_img_s").className="checked";HD.$("shortcut_img_140").className=""}else{HD.shortcutMenu.element.src=b.indexOf("_s.")>-1?b.replace("_s.","_140."):b.replace(/\.(\w{3})$/i,"_140.$1");HD.$("shortcut_img_s").className="";HD.$("shortcut_img_140").className=
"checked"}HD.shortcutMenu.show()};d.onerror=function(){alert("\u6ca1\u6709\u5bf9\u5e94\u5c3a\u5bf8\u7684\u56fe\u7247\uff01")};d.src=c}},_checked:function(a){if(a){if((a.nodeName=="TABLE"||a.nodeName=="IMG")&&a.align){if(/left|right/i.test(a.align))HD.$("shortcut_img_"+a.align).className="checked"}else if(a.nodeName=="DIV")if(/img_l/i.test(a.className))HD.$("shortcut_img_left").className="checked";else HD.$("shortcut_img_right").className="checked";if(this.element.src.indexOf("_s.")>0)HD.$("shortcut_img_s").className=
"checked";else if(this.element.src.indexOf("_140.")>0)HD.$("shortcut_img_140").className="checked"}},img_checked:function(){var a=this.element,b=a.parentNode,c=b.nodeName;HD.$("shortcut_img_left").className="";HD.$("shortcut_img_right").className="";HD.$("shortcut_img_s").className="";HD.$("shortcut_img_140").className="";HD.$("shortcut_img_des").style.display="";if((c=="A"||c=="P")&&b.parentNode.nodeName=="TD"){if(b.parentNode.getElementsByTagName("IMG").length==1){c="TD";b=b.parentNode}}else if(c==
"A"&&b.parentNode.nodeName=="DIV"){c="DIV";b=b.parentNode}else if(c=="TD")if(b.parentNode.getElementsByTagName("IMG").length>1)c="IMG";switch(c){case "P":case "BODY":case "A":if(/right/i.test(a.align)){b=parseInt(HD.$("shortcut_img").style.left)-HD.$("shortcut_img").offsetWidth+a.offsetWidth;HD.$("shortcut_img").style.left=b+"px"}this._checked(a);break;case "DIV":c=b;var d=c.getElementsByTagName("strong")||c.getElementsByTagName("font");b=parseInt(HD.$("shortcut_img").style.left);var e=parseInt(HD.$("shortcut_img").style.top);
if(HD.browser=="IE"){e-=13;b-=18}else{e-=6;b-=10}HD.$("shortcut_img").style.top=e+"px";HD.$("shortcut_img").style.left=b+"px";if(d.length==1)HD.$("shortcut_img_des").style.display="none";this.table=c;if(/img_r/i.test(c.className)){b=parseInt(HD.$("shortcut_img").style.left)-HD.$("shortcut_img").offsetWidth+c.offsetWidth;HD.$("shortcut_img").style.left=b+"px"}this._checked(c);this._img_cursor_position(a);break;case "TD":b=b.parentNode.parentNode;this.table=c=b.nodeName=="TBODY"?b.parentNode:b;b=b.getElementsByTagName("tr");
d=b[0].getElementsByTagName("td");if(b.length==2&&d.length==1)HD.$("shortcut_img_des").style.display="none";if(/right/i.test(c.align)){b=parseInt(HD.$("shortcut_img").style.left)-HD.$("shortcut_img").offsetWidth+c.offsetWidth;HD.$("shortcut_img").style.left=b+"px"}this._checked(c);this._img_cursor_position(a);break;default:this._checked(a)}},img_reset:function(){var a=this.element||this.table;if(a){a.removeAttribute("width",false);a.removeAttribute("height",false);a.style.width="";a.style.height=
""}},_img_cursor_position:function(a){var b=this.id,c,d;pel=a.parentNode;if(pel.nodeName=="A"&&pel.parentNode.nodeName=="TD"){d=pel.parentNode;d=d.parentNode.parentNode;this.table=d.nodeName=="TBODY"?d.parentNode:d;this.element=a;d=d.getElementsByTagName("tr");if(d.length==1){d=d[0].getElementsByTagName("font");if(d.length==0)return false;else{d=d[0];HD.$("shortcut_img_des").style.display="none"}}else if(d.length==2){d=d[1].getElementsByTagName("td")[0];HD.$("shortcut_img_des").style.display="none"}else return false}else if(pel.nodeName==
"A"&&pel.parentNode.nodeName=="DIV"){d=pel.parentNode;d=d.getElementsByTagName("strong")||d.getElementsByTagName("font");if(d.length==1)d=d[0];else return false}else if(pel.nodeName=="DIV"){d=a.parentNode;d=d.getElementsByTagName("strong")||d.getElementsByTagName("font");if(d.length==1)d=d[0];else return false}if(HD.browser=="IE")try{var e=a.cloneNode();pel.insertBefore(e,a);pel.removeChild(a);this.element=e;c=HD.g[b].idocument.body.createTextRange();c.moveToElementText(d);c.collapse(true);c.select()}catch(f){}else if(d){HD.util.selection(b);
c=HD.g[b].range;if(d.hasChildNodes()&&d.childNodes[0].nodeType==1)d=d.childNodes[0];c.selectNodeContents(d);c.collapse(true)}},img_add_des_div:function(){var a=this.id,b=this.element;this._img_add_des_div(this.table,b);HD.history.add(a,false);b=HD.$("img_tmp_id",HD.g[a].idocument);b.removeAttribute("id");HD.shortcutMenu._img_cursor_position(b);HD.$("shortcut_img_des").style.display="none"},_img_add_des_div:function(a,b){var c=this.id,d="",e="img_r",f="&nbsp;",g=0,h="";b=b||a.getElementsByTagName("IMG")[0];
if(a)g=a.getElementsByTagName("IMG").length;if(a&&g==1){f=a.innerText||a.textContent||"&nbsp;";f=HD.util.trim(f);e=a.align?a.align=="right"?"img_r":"img_l":/img_l/i.test(a.className)?"img_l":"img_r"}else e=b.align=="right"?"img_r":"img_l";d='<IMG id="img_tmp_id" src="'+b.src+'"';if(b.alt)d+=' alt="'+b.alt+'"';if(b.title)d+=' title="'+b.title+'"';d+="/>";if(b.parentNode.nodeName=="A")h=b.parentNode.href;else if(HD.util.isHudong()){h=b.src.match(/http:\/\/(a\d)\.att\.hudong\.com\/(\d{2})\/(\d{2})\/(\d{20,32})_[\w]{1,3}\.(\w{3})/i);
h="http://tupian.baike.com/"+h[1]+"_"+h[2]+"_"+h[3]+"_"+h[4]+"_"+h[5]+".html"}else{h=b.getAttribute("src");h=h.replace(/_(s|140)\./,".")}d='<A href="'+h+'" target="_blank" title="'+f+'">'+d+"</A>";d+="<STRONG>"+f+"</STRONG>";c=HD.$$("div",HD.g[c].idocument);c.className="img "+e;c.style.width=b.width+"px";c.innerHTML=d;if(a&&g==1){a.parentNode.insertBefore(c,a);a.parentNode.removeChild(a)}else{if(b.parentNode.nodeName=="A")b=b.parentNode;b.parentNode.insertBefore(c,b);b.parentNode.removeChild(b)}},
ref_edit:function(){var a=this.element.getAttribute("name");HD.plugin.refer.ref_edit(a);HD.$("shortcut_ref").style.display="none"},ref_remove:function(){var a=this.element,b=a.getAttribute("name");a.parentNode.removeChild(a);HD.$("shortcut_ref").style.display="none";HD.plugin.refer.ref_remove(b)}};
HD.create=function(a,b){hdeditor_resize();if(HD.browser=="IE")try{document.execCommand("BackgroundImageCache",false,true)}catch(c){}var d=HD.$(a);b=typeof b=="undefined"?0:b;if(!(b==0&&HD.g[a].container!=null)){var e=d.style.width,f=d.style.height,g;if(HD.g[a].id_container)g=HD.$(HD.g[a].id_container);else{g=HD.$$("div");g.className="hd-container";g.style.width=e;g.style.height=f;b==1?document.body.appendChild(g):d.parentNode.insertBefore(g,d)}var h=HD.toolbar.create(a);HD.g[a].position_toolbar?HD.$(HD.g[a].position_toolbar).appendChild(h):
g.appendChild(h);if(HD.g[a].id_toolbar)h=HD.$(HD.g[a].id_toolbar);var k=HD.util.trim(d.value);k||(k="<p>&nbsp;</p>");var n=HD.$$("iframe");n.className="hd-iframe";n.setAttribute("frameBorder","0");HD.g[a].autoHeight&&n.setAttribute("scrolling","no");n.style.height=HD.g[a].minHeight+"px";n.style.width="100%";e=HD.$$("textarea");e.className="hd-textarea";e.style.display="none";if(HD.g[a].position_content){HD.$(HD.g[a].position_content).appendChild(n);HD.$(HD.g[a].position_content).appendChild(e);f=
HD.$(HD.g[a].position_content)}else{f=HD.$$("div");f.className="hd-form";f.appendChild(n);f.appendChild(e);g.appendChild(f)}var q=HD.$$("table");q.className="hd-bottom";q.cellPadding=0;q.cellSpacing=0;q.border=0;var s=q.insertRow(0),r=s.insertCell(0);r.className="hd-bottom-left";s=s.insertCell(1);s.className="hd-bottom-right";var p=HD.$$("img");p.className="hd-bottom-right-img";p.src=HD.g[a].skinsPath+"spacer.gif";s.appendChild(p);g.appendChild(q);var w=HD.$$("div");w.style.display="none";document.body.appendChild(w);
var t=HD.$$("div");t.className="hd-mask";HD.util.setOpacity(t,40);document.body.appendChild(t);d.style.display="none";HD.util.setDefaultPlugin(a);var v=n.contentWindow;p=HD.util.getIframeDoc(n);p.designMode="On";k=HD.util.getFullHtml(a,k);p.open();p.write(k);p.close();if(!HD.g[a].wyswygMode){e.value=d.value;e.style.display="block";n.style.display="none";HD.toolbar.disable(a,["save","preview","source","preview","fullscreen"])}if(HD.g[a].autoOnsubmitMode){for(k=d.parentNode;k!=null&&k.tagName!="FORM";)k=
k.parentNode;k!=null&&k.tagName=="FORM"&&HD.event.add(k,"submit",new Function('HD.util.setData("'+a+'")'))}try{HD.event.add(p,"click",new Function('if(typeof HD!="undefined") HD.layout.hide("'+a+'")'));HD.event.add(p,"keyup",new Function('if(typeof HD!="undefined") HD.history.add("'+a+'", true)'))}catch(u){}HD.g[a].container=g;HD.g[a].toolbarDiv=h;HD.g[a].formDiv=f;HD.g[a].iframe=n;HD.g[a].newTextarea=e;HD.g[a].srcTextarea=d;HD.g[a].bottom=q;HD.g[a].hideDiv=w;HD.g[a].maskDiv=t;HD.g[a].iframeWin=v;
HD.g[a].idocument=p;e=g.offsetWidth;f=g.offsetHeight;HD.g[a].width=e+"px";HD.g[a].height=f+"px";HD.g[a].toolbarTop=HD.util.getElementPos(h).y;HD.g[a].domFilterResult="";HD.util.resize(a,e,f);HD.util.drag(a,s,g,function(m,l,o,x,y,z){if(HD.g[a].resizeMode==2)HD.util.resize(a,o+z,x+y);else HD.g[a].resizeMode==1&&HD.util.resize(a,o,x+y)});HD.util.drag(a,r,g,function(m,l,o,x,y){HD.util.resize(a,o,x+y)});HD.g[a].resizeMode||HD.util.hideBottom(a);setTimeout(function(){HD.history.add(a,false);HD.util.autoHeight(a);
hdeditor_resize();HD.util.checkExternalLink(a)},500);HD.toolbar.disable_one(a,"undo");HD.toolbar.disable_one(a,"redo");if(HD.browser=="IE"){setTimeout(function(){HD.util.selection(a);var m=HD.g[a].range;m.moveStart("sentence",-999999);m.moveEnd("sentence",-999999);m.collapse(true);m.select()},500);HD.$("hd_container").onselectstart=function(){return false};HD.event.add(p.body,"drop",function(m){if(m.dataTransfer.getData("text")){HD.shortcutMenu.hide();HD.history.add(a,false)}else return false})}setInterval(function(){HD.util.autoHeight(a)},
1E3);HD.event.add(p,"keydown",function(m){return HD.util.editorEvent(HD.browser=="IE"?n.contentWindow.event:m,a)});HD.event.add(p,"click",function(m){HD.g[a].layoutDiv=null;HD.shortcutMenu.show(a,HD.util.getParentElement(a),m);return HD.util.editorEvent(HD.browser=="IE"?n.contentWindow.event:m,a)});HD.event.add(p,"keydown",function(m){var l=m.keyCode,o=HD.util.getParentElement(a);if(o.tagName=="SUP"&&/refer/i.test(o.className)){if(l>=37&&l<=40)return true;else if(l==8||l==46){HD.shortcutMenu.hide();
o.parentNode.removeChild(o);if(HD.browser=="IE")m.returnValue=false;else m.preventDefault();return false}HD.util.cursorToNext(a,o)}HD.shortcutMenu.hide()});HD.event.add(p,"mousedown",function(m){var l=m=m.target||m.srcElement,o=m.tagName;if(!HD.iframeClickTag||HD.iframeClickTag!=o){for(;l&&l.nodeName!="BODY";){if(l.nodeName=="TD")break;l=l.parentNode}l&&l.nodeName=="TD"?HD.toolbar.able(a,["title1","title2"]):HD.toolbar.able(a,[])}if(o!="A"&&/^strong|b|em|i|u$/i.test(m.tagName))for(l=m;l&&l.nodeName!=
"BODY";){if(l.nodeName=="A"){o="A";m=l;break}l=l.parentNode}if(o=="A"){HD.iframeClickA=m;HD.toolbar.disable(a,["save","preview","cut","copy","source","bold","fontstyle","innerlink","link"])}HD.iframeClickTag=o});HD.event.add(p,"mouseup",function(m){m=m.target||m.srcElement;var l=m.tagName;if(/<\/table>|hdwiki_tmml/i.test(HD.util.getSelectedText(a,"html"))){HD.iframeClickTag="";HD.toolbar.disable(a,["save","preview","copy","refer","source"])}else{var o=HD.util.getSelectedText(a);if(o)o=HD.util.trim(o);
if(o)if(HD.util.strlen(o)>40||/[\n\r\*#%~><\/\\]/i.test(o)){HD.toolbar.disable_one(a,"title1");HD.toolbar.disable_one(a,"title2");HD.toolbar.disable_one(a,"innerlink");HD.iframeClickTag=""}HD.browser=="IE"&&m.nodeName=="IMG"&&HD.shortcutMenu.show(a,m);if(l!="A"&&/^strong|b|em|i|u$/i.test(m.tagName))for(o=m;o&&o.nodeName!="BODY";){if(o.nodeName=="A"){l="A";m=o;break}o=o.parentNode}if(HD.iframeClickTag==l)if(l=="A")HD.iframeClickA==m?HD.toolbar.disable(a,["save","preview","cut","copy","source","bold",
"fontstyle","innerlink","link"]):HD.toolbar.disable(a,["save","preview","copy","source"]);else HD.iframeClickA="";else{if(l=="A"||HD.iframeClickTag=="A")HD.toolbar.disable(a,["save","preview","cut","copy","source"]);HD.iframeClickTag="";HD.iframeClickA=""}}});HD.event.add(HD.browser=="IE"?p.body:p,"paste",function(m){var l=HD.util.getParentElement(a);if(l.nodeName=="DIV"&&l.className.indexOf("hdwiki_tmml")>-1){HD.util.showTip(a,"\u8bf7\u4e0d\u8981\u5728\u76ee\u5f55\u4e0a\u6267\u884c\u7c98\u5e16\u64cd\u4f5c\u3002");
if(HD.browser=="IE")m.returnValue=false;else m.preventDefault();return false}if(!HD.util.filterIgnore()&&HD.g[a].filterExternal){if(HD.browser=="IE"){l=window.clipboardData.getData("text");if(!l)return false;if(window.clipboardData.setData("Text",l)){if(l=window.clipboardData.getData("text")){l=HD.util.filter65279(l);l=HD.util.escape(l);l=l.replace(/\n/g,"<br />\n");HD.util.insertHtml(a,l)}}else HD.plugin.dopaste.click(a);m.returnValue=false}else{HD.plugin.dopaste.click(a);m.preventDefault()}return false}HD.timeout&&
clearTimeout(HD.timeout);HD.timeout=setTimeout(function(){HD.util.checkExternalLink(a)},500)});setTimeout(function(){HD.plugin.refer&&HD.plugin.refer.loaddata(1)},500);HD.timeout=setTimeout(function(){HD.util.checkExternalLink(a)},1E3);HD.timeout=setTimeout(function(){HD.util.clearEmptyTag(a)},2E3);HD.timeout=setTimeout(function(){HD.util.clearEmptyTag(a)},3E3);HD.timeout=setTimeout(function(){HD.util.clearEmptyTag(a)},5E3);setInterval(function(){HD.util.checkExternalLink(a)},2E4);HD.event.add(window,
"scroll",function(m){HD.util.autoToolbarTop(a,"scroll");HD.shortcutMenu.hide();HD.layout.hide(a,m);if(HD.g[a].layoutDiv&&!/dialog/i.test(HD.g[a].layoutDiv.className))HD.g[a].layoutDiv=null});HD.event.add(document,"keydown",function(m){if(m.keyCode==27)if(HD.g[a].hideDiv.innerHTML&&HD.event.esc==1){HD.util.select(a);HD.util.focus(a);HD.layout.hide(a)}});HD.event.add(document.body,"click",function(m){var l=m.target||m.srcElement;l=l.nodeName.toLowerCase()=="span"?l.parentNode||l:l;if(!l||l.id&&l.id.indexOf("shortcut")>
-1)return false;HD.shortcutMenu.hide();if(!(l&&/hd-icon/i.test(l.className))){l=HD.g[a].hideDiv.childNodes;if(l.length==1)if((l=l[0])&&/dialog/i.test(l.className))return;HD.layout.hide(a,m);HD.g[a].layoutDiv=null}});HD.util.isIE6()?setInterval(function(){hdeditor_resize("resize")},2E3):HD.event.add(window,"resize",function(){hdeditor_resize()});HD.shortcutMenu.init(a);HD.util.addSubmitIframe()}};HD.version="1.0";HD.scriptPath=HD.util.getScriptPath();HD.htmlPath=HD.util.getHtmlPath();HD.browser=HD.util.getBrowser();
HD.userAgent=navigator.userAgent.toLowerCase();HD.plugin={};HD.g={};
HD.init=function(a){a.wyswygMode=typeof a.wyswygMode=="undefined"?true:a.wyswygMode;a.autoOnsubmitMode=typeof a.autoOnsubmitMode=="undefined"?true:a.autoOnsubmitMode;a.resizeMode=typeof a.resizeMode=="undefined"?0:a.resizeMode;a.filterMode=typeof a.filterMode=="undefined"?true:a.filterMode;a.skinType=a.skinType||"default";a.cssPath=a.cssPath||"";a.skinsPath=a.skinsPath||HD.scriptPath+"skins/";a.pluginsPath=a.pluginsPath||HD.scriptPath+"plugins/";a.minWidth=a.minWidth||200;a.minHeight=a.minHeight||
100;a.maxHeight=a.maxHeight||5E4;a.minChangeSize=a.minChangeSize||5;a.siteDomains=a.siteDomains||[];var b=["copy","cut","paste","fontstyle","title1","title2","image","media","table","source"];a.defaultItems=b;a.items=a.items||b;a.id_container=a.id_container||"";a.id_toolbar=a.id_toolbar||"";a.position_toolbar=a.position_toolbar||"";a.position_content=a.position_content||"";a.filterExternal=typeof a.filterExternal=="undefined"?1:a.filterExternal;a.autoHeight=typeof a.autoHeight=="undefined"?1:a.autoHeight;
b={font:[],span:["class","style",".font-weight",".font-style",".text-decoration"],div:["class","style",".width",".text-align"],a:["class","href","target","title","name"],img:["src","alt","title","align","class","/"],br:["/"],p:["class","align","style",".text-align"],table:["class","style","width",".width","align"],tbody:[],tr:["class"],th:["class","align","colspan","rowspan","width"],td:["class","align","colspan","rowspan","width"],strong:["class","style",".width"],b:["class"],sub:["class"],sup:["class",
"name"],h2:["class"],h3:["class"],h4:["class"],h5:["class"],h6:["class"],em:["class"],i:["class"],u:["class"]};if(HD.util.inArray("media",a.items)){b.embed=["style","src","type","loop","autostart","quality",".width",".height","flename","width","height","volume","pluginspage","console","controls","/"];b.object=["classid","class","id","width","height","codebase"];b.param=["name","value"]}a.htmlTags=a.htmlTags||b;HD.g[a.id]=a;HD.g[a.id].undoStack=[];HD.g[a.id].redoStack=[];HD.util.loadStyle(a.skinsPath+
a.skinType+".css");HD.id=HD.id||a.id};HD.show=function(a){HD.init(a);HD.event.add(window,"load",new Function('HD.create("'+a.id+'")'))};HD.plugin.clean={click:function(a){if(HD.g[a].isClean==true)HD.util.autoCloseTip(a,"\u5185\u5bb9\u4e0d\u9700\u8981\u6574\u7406",1.5);else{HD.history.add(a,false);HD.util.uploading(a,"\u6b63\u5728\u6574\u7406\u5185\u5bb9\uff0c\u8bf7\u7a0d\u7b49...");setTimeout(function(){if(HD.util.changeData(a,HD.util.getData(a))){HD.$("hd_dialog_tip").innerHTML="\u6574\u7406\u5b8c\u6bd5\u3002";setTimeout(function(){HD.g[a].isClean=true;HD.layout.hide(a)},1E3)}},500)}}};
HD.plugin.tip={callback:null,click:function(a,b,c,d){this.callback=c;(new HD.dialog2({id:a,cmd:"tip",content:'<li><div style="width:300px">'+b+"</div></li>",width:350,height:200,title:"\u63d0\u793a",yesButton:"\u767b\u9646",noButton:HD.lang.close,notFocus:d})).show();return true},exec:function(){typeof this.callback=="function"&&this.callback()}};
HD.plugin.save={click:function(a){/baike.com/i.test(location.host)?HD.buttonEvent.saveDoc():autoSave(0,function(){HD.util.showTip(a,"\u4fdd\u5b58\u6210\u529f");setTimeout(function(){HD.layout.hide(a)},1E3)})}};HD.plugin.preview={click:function(){/(hudong|baike).com/i.test(location.host)?HD.buttonEvent.previewDoc():previewDoc()}};HD.plugin.undo={click:function(a){HD.history.undo(a)}};HD.plugin.redo={click:function(a){HD.history.redo(a)}};
HD.plugin.bold={click2:function(){},click:function(a){HD.util.execCommand(a,"bold",null)}};HD.plugin.italic={click2:function(){},click:function(a){HD.util.select(a);HD.util.execCommand(a,"italic",null)}};HD.plugin.underline={click2:function(){},click:function(a){HD.util.selection(a);HD.util.execCommand(a,"underline",null)}};
HD.plugin.source={click:function(a){var b;b=HD.g[a].idocument.body.innerHTML;b=HD.util.filterData(b);HD.objectList=[];if(/<\/object>/i.test(b)){HD.objectList=b.match(/<object.*?>[\s\S]*?<\/object>/ig);for(var c=0;c<HD.objectList.length;c++)b=b.replace(HD.objectList[c],"{object"+c+"}")}(new HD.dialog2({id:a,cmd:"source",content:'<li><textarea id="hd_input_source" style="width:720px;height:400px;"></textarea></li>',width:780,height:450,title:HD.lang.source,yesButton:HD.lang.yes,noButton:HD.lang.no,
notFocus:true})).show();document.onselectstart=null;setTimeout(function(){HD.$("hd_input_source").value=b},500)},exec:function(a){var b=HD.g[a];HD.g[a].isClean=false;try{var c=HD.util.trim(HD.$("hd_input_source").value);if(c.indexOf("<")==-1)c="<p>"+c+"</p>";else if(c){if(HD.g[a].filterMode){c=c.replace(/<(style|(no)?script|select|object|textarea|iframe|title|option|noframes|map|applet).*?>[\s\S]*?<\/\1>/gi,"");c=c.replace(/<\!--[\s\S]*?--\>/gi,"");c=c.replace(/<(link|input|form|center|base|button|frame(set)?|area|meta)[^>]*?>/gi,
"");c=c.replace(/<\/(form|center|frameset)>/gi,"")}if(HD.objectList.length)for(var d=0;d<HD.objectList.length;d++)c=c.replace("{object"+d+"}",HD.objectList[d])}c=HD.util.filter65279(c);b.idocument.body.innerHTML=c||"<p>&nbsp;</p>"}catch(e){}HD.history.add(a,false);HD.layout.hide(a);if(!/baike\.com/.test(location.href))document.onselectstart=function(){return false};setTimeout(function(){HD.util.checkExternalLink(a)},500)}};
HD.plugin.dopaste={click:function(a){(new HD.dialog2({id:a,cmd:"dopaste",content:'<li><div>\u7531\u4e8e\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u5141\u8bb8\u7f16\u8f91\u5668\u8bbf\u95ee\u526a\u8d34\u677f\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952e(Ctrl+V)\u628a\u5185\u5bb9\u7c98\u8d34\u5230\u65b9\u6846\u91cc\uff0c\u518d\u6309 <b>\u786e\u5b9a</b> \u6309\u94ae\u3002</div>\t\t<textarea name="hd_input_dopaste" id="hd_input_dopaste" style="width:720px;height:400px;"></textarea></li>',width:780,height:450,title:HD.lang.dopaste,
yesButton:HD.lang.yes,noButton:HD.lang.close})).show();document.onselectstart=null},exec:function(a){var b=HD.$("hd_input_dopaste").value;b=HD.util.filter65279(b);b=HD.util.escape(b);if(b!=""){b=b.replace(/\n/g,"<br>\n");HD.util.insertHtml(a,b)}HD.util.select(a);HD.layout.hide(a);HD.util.focus(a);return false}};
HD.plugin.media={click:function(a){if(HD.util.isAtImg(a))return HD.util.showTip(a,"\u5f53\u524d\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0d\u9002\u5408\u653e\u7f6e\u591a\u5a92\u4f53\u6587\u4ef6\uff01");HD.util.selection(a);(new HD.dialog2({id:a,cmd:"media",content:'<li><strong>\u6587\u4ef6\u7f51\u7edc\u5730\u5740\uff1a</strong>\t\t<input type="text" class="inp_txt" id="hd_media_url" value="http://" style="width:280px;" />\t\t<label class="gray">\u652f\u6301.wmv .rmvb .mp3 .wma .swf\u6587\u4ef6\u683c\u5f0f</label>\t\t</li>\t\t<li><strong>\u6587\u4ef6\u663e\u793a\u5927\u5c0f\uff1a</strong>\t\t<p>\u5bbd\u5ea6 <input type="text" class="inp_txt" id="hd_media_width" value="320" maxlength="3" size="10" /></p>\t\t<p>\u9ad8\u5ea6 <input type="text" class="inp_txt" id="hd_media_height" value="240" maxlength="3" size="10" /></p>\t\t</li>\t\t<li id="hd_dialog_tip" class="hd-dialog-tip"></li>',
width:350,height:260,title:HD.lang.media,yesButton:HD.lang.yes,noButton:HD.lang.no})).show()},check:function(a,b,c,d){if(!b.match(/^\w+:\/\/.{3,}\.(swf|mp3|wma|wmv|mid|asf|rm|rmvb)(\?|$)/i)){HD.$("hd_dialog_tip").style.display="block";HD.$("hd_dialog_tip").innerHTML="\u8bf7\u8f93\u5165\u4e00\u4e2a\u6709\u6548\u7684\u89c6\u9891\u6587\u4ef6\u5730\u5740\uff01";HD.$("hd_media_url").focus();return false}if(isNaN(parseInt(c))||c<200){HD.$("hd_dialog_tip").style.display="block";HD.$("hd_dialog_tip").innerHTML=
"\u5bbd\u5ea6\u5fc5\u987b\u662f\u4e00\u4e2a\u5927\u4e8e 200 \u7684\u6574\u6570\u3002";HD.$("hd_media_width").focus();return false}if(isNaN(parseInt(d))||d<200){HD.$("hd_dialog_tip").style.display="block";HD.$("hd_dialog_tip").innerHTML="\u9ad8\u5ea6\u5fc5\u987b\u662f\u4e00\u4e2a\u5927\u4e8e 200 \u7684\u6574\u6570\u3002";HD.$("hd_media_height").focus();return false}return true},exec:function(a){HD.util.select(a);var b=HD.$("hd_media_url").value,c=HD.$("hd_media_width").value,d=HD.$("hd_media_height").value;
b=HD.util.trim(b);c=HD.util.trim(c);d=HD.util.trim(d);if(!this.check(a,b,c,d))return false;b=this.getHtml(c,d,b);HD.util.insertHtml(a,b);HD.layout.hide(a);HD.util.focus(a);return false},getHtml:function(a,b,c){var d="";if(/\.(rm|rmvb)$/i.test(c))d='<OBJECT ID=video1 CLASSID="clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA" HEIGHT='+b+" WIDTH="+a+'><param name="_ExtentX" value="9313"><param name="_ExtentY" value="7620"><param name="AUTOSTART" value="0"><param name="SHUFFLE" value="0"><param name="PREFETCH" value="0"><param name="NOLABELS" value="0"><param name="SRC" value="'+
c+'"><param name="CONTROLS" value="ImageWindow"><param name="CONSOLE" value="Clip1"><param name="LOOP" value="0"><param name="NUMLOOP" value="0"><param name="CENTER" value="0"><param name="MAINTAINASPECT" value="0"><param name="BACKGROUNDCOLOR" value="#000000"><embed SRC="'+c+'" type="audio/x-pn-realaudio-plugin" CONSOLE="Clip1" CONTROLS="ImageWindow" HEIGHT="'+b+'" WIDTH="'+a+'" AUTOSTART="false"></OBJECT>';else if(/\.(wmv|asf)$/i.test(c))d="<object align=center classid=CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95 class=OBJECT id=MediaPlayer width="+
a+" height="+b+' ><param name=AUTOSTART VALUE=true ><param name=ShowStatusBar value=-1><param name=Filename value="'+c+'"><embed type=application/x-oleobject flename=mp src="'+c+'" width='+a+" height="+b+"></embed></object>";else if(/\.(wma)$/i.test(c))d='<object classid="clsid:22D6F312-B0F6-11D0-94AB-0080C74C7E95" id="MediaPlayer1" ><param name="Filename" value="'+c+'"><param name="PlayCount" value="1"><param name="AutoStart" value="0"><param name="ClickToPlay" value="1"><param name="DisplaySize" value="0"><param name="EnableFullScreen Controls" value="1"><param name="ShowAudio Controls" value="1"><param name="EnableContext Menu" value="1"><param name="ShowDisplay" value="1"></object>';
else if(/\.(mp3|mid)$/i.test(c))d='<EMBED src="'+c+'" width='+a+" height="+b+" volume=70 autostart=true></EMBED>";else if(/\.(swf)$/i.test(c))d='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="'+a+'" height="'+b+'"><param name="movie" value="'+c+'" /><param name="quality" value="high" /><embed src="'+c+'" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="'+
a+'" height="'+b+'"></embed></object>';return d}};
HD.plugin.specialchar={click:function(a){var b=HD.lang.charTable2;HD.util.selection(a);var c=new HD.menu({id:a,cmd:"specialchar",width:"240px"});if(!c.add)return false;var d=HD.$$("table");d.cellPadding=0;d.cellSpacing=2;d.border=0;d.className="selectTable";for(var e=0;e<b.length;e++)for(var f=d.insertRow(e),g=0;g<b[e].length;g++){var h=f.insertCell(g);h.onmouseover=function(){this.className="hover"};h.onmouseout=function(){this.className=""};h.onclick=new Function('HD.plugin["specialchar"].exec("'+
a+'", "'+b[e][g]+'")');h.innerHTML=b[e][g]}a=HD.$$("div");a.className="othermark";a.innerHTML='<a href="http://service.baike.com/article-940349.html#3" target="_black">\u63d2\u5165\u5176\u4ed6\u7b26\u53f7</a>';c.append(d);c.append(a);c.show()},exec:function(a,b){HD.util.select(a);HD.util.insertHtml(a,b);HD.layout.hide(a);HD.util.focus(a);HD.g[a].layoutDiv=null}};
HD.plugin.table={click:function(a){var b=HD.util.isAtImg(a);if(b)return HD.util.showTip(a,"\u5f53\u524d\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0d\u80fd\u8fdb\u884c\u8868\u683c\u64cd\u4f5c\uff01");var c=HD.lang.hdTable;HD.util.selection(a);var d=new HD.menu({id:a,cmd:"table"});if(!d.add)return false;for(var e=HD.util.getParentElement(a),f=e;f&&f.nodeName!="BODY";){if(f.nodeName=="TD"){e=f;break}f=f.parentNode}var g=false;HD.each(c,function(h,k){var n;if(h=="insertTable")n=(g=b?true:e.nodeName=="TD")?
"<span>"+k+"</span>":'<span onmouseover=\'HD.plugin["table"].selectTable("'+a+"\", this)'>"+k+"</span>";else{n='<span onmouseover=\'HD.plugin["table"].hide("'+a+"\")'>"+k+"</span>";g=b?true:e.nodeName!="TD"}var q=new Function('HD.plugin["table"].'+h+'("'+a+'")');d.add(n,q,g)});d.show()},insertTable:function(){return false},insertRowUp:function(a,b){var c=HD.util.moveToAncestorNode(a,"TR");if(null!=c){var d=c.parentNode.insertRow(c.rowIndex+(b||0));c=c.cells.length;for(var e=0;e<c;e++){var f=d.insertCell(e);
HD.browser!="IE"&&f.appendChild(HD.$$("br"))}HD.layout.hide(a);HD.util.focus(a)}},insertRowDown:function(a){this.insertRowUp(a,1)},insertColumnLeft:function(a,b){var c=HD.util.moveToAncestorNode(a,"TD");if(null!=c){b=c.cellIndex+(b||0);c=c.parentNode.parentNode;for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d).insertCell(b);if(HD.browser!="IE"){document.createElement("br");e.appendChild(HD.$$("br"))}}HD.layout.hide(a);HD.util.focus(a)}},insertColumnRight:function(a){this.insertColumnLeft(a,1)},
deleteTable:function(a){var b=HD.util.moveToAncestorNode(a,"TABLE");b&&b.parentNode.removeChild(b);HD.util.focus(a)},deleteRow:function(a){var b=HD.util.moveToAncestorNode(a,"TR");b&&b.parentNode.removeChild(b);HD.util.focus(a)},deleteColumn:function(a){var b=HD.util.moveToAncestorNode(a,"TD");if(null!=b){var c=b.cellIndex;b=b.parentNode.parentNode;for(var d=0;d<b.rows.length;d++)b.rows.item(d).deleteCell(c);HD.util.focus(a)}},selected:function(a,b,c){var d=b.toString(10)+"\u884c "+c.toString(10)+
"\u5217";HD.$("tableLocation"+a).innerHTML=d;for(d=1;d<=10;d++)for(var e=1;e<=10;e++)HD.$("tableTd"+a+d.toString(10)+"_"+e.toString(10)+"").className=d<=b&&e<=c?"hover":""},html:function(a){for(var b='<table class="selectTable">',c=1;c<=10;c++){b+="<tr>";for(var d=1;d<=10;d++){var e=c.toString(10)+","+d.toString(10);b+='<td id="tableTd'+a+c.toString(10)+"_"+d.toString(10)+"\"onclick=\"javascript:HD.plugin['table'].exec('"+a+"', '"+e+"');\" onmouseover=\"javascript:HD.plugin['table'].selected('"+a+
"', '"+c.toString(10)+"', '"+d.toString(10)+"');\">&nbsp;</td>"}b+="</tr>"}b+='<tr><td colspan="10" id="tableLocation'+a+'" class="tableLocation"></td></tr>';b+="</table>";return b},selectTable:function(a,b){var c,d,e=HD.util.getElementPos(b),f=document.documentElement.clientWidth||document.body.clientWidth;c=document.getElementsByTagName("body")[0];var g=parseInt(c.offsetWidth);if(HD.$("selectTable")){c=HD.$("selectTable");c.style.display="block";c.style.top=e.y-7+"px";e.x-=(f-g)/2;c.style.left=
e.x+b.parentNode.offsetWidth-5+"px";c.onmouseover=function(){b.parentNode.className="hd-menu-selected"};c.focus()}else{d=this.html(a);c=HD.$$("div");c.id="selectTable";c.className="hd-menu";e.x-=(f-g)/2;c.style.width="240px";c.style.top=e.y-7+"px";c.style.left=e.x+b.parentNode.offsetWidth-5+"px";c.innerHTML=d;c.onmouseover=function(){b.parentNode.className="hd-menu-selected"};c.onselectstart=function(){return false};document.body.appendChild(c);c.focus();HD.event.add(HD.g[a].idocument,"click",function(){HD.plugin.table.hide(a)});
HD.event.add(HD.g[a].toolbarDiv,"click",function(){HD.plugin.table.hide(a)})}},hide:function(a){if(HD.$("selectTable")){HD.$("selectTable").style.display="none";for(var b=1;b<=10;b++)for(var c=1;c<=10;c++)HD.$("tableTd"+a+b.toString(10)+"_"+c.toString(10)+"").className="";HD.$("tableLocation"+a).innerHTML=""}},exec:function(a,b){HD.util.select(a);for(var c=b.split(","),d='<table class="table">',e=0;e<c[0];e++){d+="<tr>";for(var f=0;f<c[1];f++)d+="<td>&nbsp;</td>";d+="</tr>"}d+="</table>";HD.util.insertHtml(a,
d);HD.$("selectTable").style.display="none";HD.layout.hide(a);HD.util.focus(a);HD.g[a].layoutDiv=null}};
HD.plugin.fontstyle={click:function(a){var b=HD.g[a].skinsPath;HD.util.selection(a);var c=new HD.menu({id:a,cmd:"fontstyle"});if(!c.add)return false;c.add('<img class="hd-icon-bold" src="'+b+'/spacer.gif"/><a href="#" class="hd-menu-a" onclick="return false;">'+HD.lang.bold.replace(/ .+$/i,"")+"</a>",new Function('HD.plugin["bold"].click("'+a+'");'));c.add('<img class="hd-icon-italic" src="'+b+'/spacer.gif"/><a href="#" class="hd-menu-a" onclick="return false;">'+HD.lang.italic.replace(/ .+$/i,"")+
"</a>",new Function('HD.plugin["italic"].click("'+a+'");'));c.add('<img class="hd-icon-underline" src="'+b+'/spacer.gif"/><a href="#" class="hd-menu-a" onclick="return false;">'+HD.lang.underline.replace(/ .+$/i,"")+"</a>",new Function('HD.plugin["underline"].click("'+a+'");'));c.add('<img class="hd-icon-sup" src="'+b+'/spacer.gif"/><a href="#" class="hd-menu-a" onclick="return false;">'+HD.lang.sup.replace(/ .+$/i,"")+"</a>",new Function('HD.plugin["sup"].click("'+a+'");'));c.add('<img class="hd-icon-sub" src="'+
b+'/spacer.gif"/><a href="#" class="hd-menu-a" onclick="return false;">'+HD.lang.sub.replace(/ .+$/i,"")+"</a>",new Function('HD.plugin["sub"].click("'+a+'");'));c.show()}};
HD.plugin.justifymore={click:function(a){var b=HD.g[a].skinsPath;HD.util.selection(a);var c=new HD.menu({id:a,cmd:"justifymore"});if(!c.add)return false;c.add('<img class="hd-icon-justifyleft" src="'+b+'/spacer.gif"/><span>'+HD.lang.justifyleft.replace(/ .+$/i,"")+"</span>",new Function('HD.util.select("'+a+'");HD.util.execCommand("'+a+'", "justifyleft", null);'));c.add('<img class="hd-icon-justifycenter" src="'+b+'/spacer.gif"/><span>'+HD.lang.justifycenter.replace(/ .+$/i,"")+"</span>",new Function('HD.util.select("'+
a+'");HD.util.execCommand("'+a+'", "justifycenter", null);'));c.add('<img class="hd-icon-justifyright" src="'+b+'/spacer.gif"/><span>'+HD.lang.justifyright.replace(/ .+$/i,"")+"</span>",new Function('HD.util.select("'+a+'");HD.util.execCommand("'+a+'", "justifyright", null);'));c.show()}};
HD.plugin.innerlink={click:function(a,b){var c=HD.g[a].toolbarIcon.innerlink;if(!c||c.className.indexOf("disabled")>-1)return false;HD.util.select(a);if((c=HD.util.getSelectedText(a,"html"))&&/<\/table>|hdwiki_tmml/i.test(c))return HD.util.showTip(a,"\u5f53\u524d\u7684\u9009\u62e9\u8303\u56f4\u5f53\u4e2d\u5305\u542b\u8868\u683c\u6216\u6807\u9898\uff0c\u4e0d\u80fd\u8f6c\u4e3a\u5185\u90e8\u94fe\u63a5\uff01");b=b||HD.util.getSelectedText(a);c=HD.util.getParentElement(a);var d=c.nodeName;if(""!=b){b=
HD.util.trim(b);if(/[\r\n\*#%~><\/\\]/i.test(b))HD.util.showTip(a,'\u5f53\u524d\u9009\u4e2d\u7684\u5185\u5bb9\u5305\u542b\u7a7a\u683c\u6216\u7279\u6b8a\u7b26\u53f7"% * \uff5e < > #  / +\uff3b\uff3d\u3010\u3011"\u7b49\uff0c\u4e0d\u80fd\u6dfb\u52a0\u4e3a\u5185\u90e8\u94fe\u63a5\uff01');else if(HD.util.strlen(b)>40)HD.util.showTip(a,"\u5185\u94fe\u6700\u591a40\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");else if(HD.util.inArray(c.className,["hdwiki_tmml","hdwiki_tmmll",
"img"]))HD.util.showTip(a,"\u5f53\u524d\u9009\u4e2d\u7684\u5185\u5bb9\u4e0d\u80fd\u6dfb\u52a0\u4e3a\u5185\u90e8\u94fe\u63a5\uff01");else{b=b.replace(/\s+/g," ");if(HD.util.isHudong()){c="http://www.baike.com/wiki/";HD.util.insertHtml(a,'<a id="hd_temp_a" class="innerlink" title="'+b+'" href="'+c+encodeURI(b)+'">'+b+"</a>");d=HD.$("hd_temp_a",HD.g[a].idocument);d.removeAttribute("id",false);d.href=c+encodeURI(b)}else HD.util.insertHtml(a,'<a class="innerlink" title="'+b+'" href="index.php?doc-innerlink-'+
encodeURI(b)+'">'+b+"</a>");HD.util.focus(a);HD.toolbar.disable(a,["save","preview","cut","copy","paste","source","bold","fontstyle","innerlink"])}}else{pel=c.parentNode;if((d=="STRONG"||d=="B")&&pel.nodeName=="A")d="A";"A"==d?HD.shortcutMenu.a_unlink():HD.util.showInput(a,"innerlink",0,"\u6700\u591a\u8f93\u516540\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01",40)}HD.iframeClickTag=""},exec:function(a){var b=HD.$("hd_input_innerlink").value;b=b.replace(/<.*?>/g,
"");if(HD.util.strlen(b)>40)return alert("\u5185\u94fe\u6700\u591a40\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");HD.util.focus(a);b!=""&&HD.plugin.innerlink.click(a,b);HD.layout.hide(a);return false}};
HD.plugin.title1={click:function(a,b){var c=HD.g[a].toolbarIcon.title1;if(!c||c.className.indexOf("disabled")>-1)return false;if(HD.util.isAtImg(a))return HD.util.showTip(a,"\u5f53\u524d\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0d\u9002\u5408\u653e\u7f6e\u6807\u9898\uff01");var d=HD.util.getSelectedText(a,"html");if(d&&/<\/table>|hdwiki_tmml/i.test(d))return HD.util.showTip(a,"\u5f53\u524d\u7684\u9009\u62e9\u8303\u56f4\u5f53\u4e2d\u5305\u542b\u8868\u683c\u6807\u9898\uff0c\u4e0d\u80fd\u8f6c\u4e3a\u6807\u9898\uff01");
b=b||HD.util.getSelectedText(a);if(""!=b){b=b.replace(/\s+/g," ");d=HD.util.getParentElement(a);HD.shortcutMenu.element&&d.nodeName=="DIV"&&/hdwiki_tmml/i.test(d.className)&&d.parentNode.removeChild(d);if(HD.util.strlen(b)>40)return HD.util.showTip(a,"\u6807\u9898\u6700\u591a40\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");HD.util.insertHtml(a,'<div class="hdwiki_tmml">'+b+"</div>");HD.util.focus(a);HD.browser!="IE"&&HD.toolbar.disable(a,["save","preview","cut",
"copy","source"])}else{d=HD.util.getParentElement(a);if(HD.shortcutMenu.element&&d.nodeName=="DIV"&&d.className=="hdwiki_tmml"){c.className=c.className.replace(/ *hd-icon-selected/i,"");HD.shortcutMenu.to_text()}else HD.util.showInput(a,"title1",0,"\u8bf7\u8f93\u5165\u8981\u8bbe\u4e3a\u4e00\u7ea7\u6807\u9898\u7684\u6587\u5b57\uff0c20\u6c49\u5b57\u4ee5\u5185\uff1a",40)}HD.iframeClickTag=""},exec:function(a){var b=HD.$("hd_input_title1").value;b=b.replace(/<.*?>/g,"");b=HD.util.trim(b);if(HD.util.strlen(b)>
40)return alert("\u6807\u9898\u6700\u591a40\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");HD.util.focus(a);if(b!=""){b=b.replace(/\s+/g," ");HD.util.insertHtml(a,'<div class="hdwiki_tmml">'+b+"</div>");HD.browser!="IE"&&HD.toolbar.disable(a,["save","preview","cut","copy","source"])}HD.layout.hide(a);return false}};
HD.plugin.title2={click:function(a,b){var c=HD.g[a].toolbarIcon.title2;if(!c||c.className.indexOf("disabled")>-1)return false;if(HD.util.isAtImg(a))return HD.util.showTip(a,"\u5f53\u524d\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0d\u9002\u5408\u653e\u7f6e\u6807\u9898\uff01");var d=HD.util.getSelectedText(a,"html");if(d&&/<\/table>|hdwiki_tmml/i.test(d))return HD.util.showTip(a,"\u5f53\u524d\u7684\u9009\u62e9\u8303\u56f4\u5f53\u4e2d\u5305\u542b\u8868\u683c\u6216\u6807\u9898\uff0c\u4e0d\u80fd\u8f6c\u4e3a\u6807\u9898\uff01");
b=b||HD.util.getSelectedText(a);if(""!=b){b=b.replace(/\s+/g," ");d=HD.util.getParentElement(a);HD.shortcutMenu.element&&d.nodeName=="DIV"&&/hdwiki_tmml/i.test(d.className)&&d.parentNode.removeChild(d);if(HD.util.strlen(b)>40)return HD.util.showTip(a,"\u6807\u9898\u6700\u591a40\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");HD.util.insertHtml(a,'<div class="hdwiki_tmmll">'+b+"</div>");HD.util.focus(a);HD.browser!="IE"&&HD.toolbar.disable(a,["save","preview",
"cut","copy","source"])}else{d=HD.util.getParentElement(a);if(HD.shortcutMenu.element&&d.nodeName=="DIV"&&d.className=="hdwiki_tmmll"){c.className=c.className.replace(/ *hd-icon-selected/i,"");HD.shortcutMenu.to_text()}else HD.util.showInput(a,"title2",0,"\u8bf7\u8f93\u5165\u8981\u8bbe\u4e3a\u4e8c\u7ea7\u6807\u9898\u7684\u6587\u5b57\uff0c20\u6c49\u5b57\u4ee5\u5185\uff1a",40)}HD.iframeClickTag=""},exec:function(a){var b=HD.$("hd_input_title2").value;b=b.replace(/<.*?>/g,"");b=HD.util.trim(b);if(HD.util.strlen(b)>
40)return alert("\u6807\u9898\u6700\u591a40\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");HD.util.focus(a);if(b!=""){b=b.replace(/\s+/g," ");HD.util.insertHtml(a,'<div class="hdwiki_tmmll">'+b+"</div>");HD.browser!="IE"&&HD.toolbar.disable(a,["save","preview","cut","copy","source"])}HD.layout.hide(a);return false}};
HD.plugin.sup={click:function(a,b){if((b=b||HD.util.getSelectedText(a))&&/<\/table>|hdwiki_tmml/i.test(b))return HD.util.showTip(a,"\u5f53\u524d\u7684\u9009\u62e9\u8303\u56f4\u5f53\u4e2d\u5305\u542b\u8868\u683c\u6216\u6807\u9898\uff0c\u4e0d\u80fd\u8f6c\u4e3a\u4e0a\u6807\uff01");if(""!=b){b=b.replace(/\s+/g," ");var c=HD.util.getParentElement(a);if(HD.shortcutMenu.element&&c.nodeName=="SUP"&&!c.className)HD.shortcutMenu.to_text();else if(HD.shortcutMenu.element&&c.nodeName=="SUP"&&c.className){c.removeAttribute("name");
c.removeAttribute("class")}else{if(HD.util.strlen(b)>20)return HD.util.showTip(a,"\u4e0a\u6807\u6700\u591a20\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");c.nodeName=="SUB"&&c.parentNode.removeChild(c);HD.util.insertHtml(a,"<sup>"+b+"</sup>");HD.util.focus(a)}}HD.iframeClickTag="";HD.layout.hide(a);return false}};
HD.plugin.sub={click:function(a,b){var c=HD.util.getSelectedText(a,"html");if(c&&/<\/table>|hdwiki_tmml/i.test(c))return HD.util.showTip(a,"\u5f53\u524d\u7684\u9009\u62e9\u8303\u56f4\u5f53\u4e2d\u5305\u542b\u8868\u683c\u6216\u6807\u9898\uff0c\u4e0d\u80fd\u8f6c\u4e3a\u4e0b\u6807\uff01");b=b||HD.util.getSelectedText(a);if(""!=b){c=HD.util.getParentElement(a);b=b.replace(/\s+/g," ");if(HD.shortcutMenu.element&&c.nodeName=="SUB"&&!c.className)HD.shortcutMenu.to_text();else if(HD.shortcutMenu.element&&
c.nodeName=="SUB"&&c.className){c.removeAttribute("name");c.removeAttribute("class")}else{if(HD.util.strlen(b)>20)return HD.util.showTip(a,"\u4e0b\u6807\u6700\u591a20\u4e2a\u5b57\u7b26\uff0c\u4e00\u4e2a\u6c49\u5b57\u7b97\u4e24\u4e2a\u5b57\u7b26\uff01");c.nodeName=="SUP"&&c.parentNode.removeChild(c);HD.util.insertHtml(a,"<sub>"+b+"</sub>");HD.util.focus(a)}}HD.iframeClickTag="";HD.layout.hide(a);return false}};HD.plugin.image={id:"",tabName:"upload",iden:"",doctitle:"",changeSrc:function(a){HD.imageSelectError=0;var b="",c=/\.(jpg|jpeg|gif|png)$/i;b=HD.$("docphotofile").value;if(b==""||!b.match(c)){this.error("\u63d0\u793a\uff1a\u8bf7\u9009\u62e9\u4e00\u4e2a\u6709\u6548\u7684\u56fe\u7247\u6587\u4ef6\uff01");return false}else HD.$("hd_dialog_tip").style.display="none";if(/MSIE/.test(navigator.userAgent)){if(b=document.getElementById("hd_img_checker"))b.src=a.value}else if(/Firefox|Safari/i.test(navigator.userAgent)){a=
document.getElementById("docphotofile");if(a.files[0].fileSize>1048576){HD.imageSelectError=1;this.error("\u63d0\u793a\uff1a\u56fe\u7247\u5927\u5c0f\u8d85\u8fc7\u9650\u5236\uff0c\u8bf7\u63a7\u5236\u57281M\u4ee5\u5185\uff01")}else HD.$("hd_dialog_tip").style.display="none"}},click:function(a){var b=this,c=HD.g[a].skinsPath,d=HD.$("_doc_title")?HD.$("_doc_title").value:"",e=HD.$("curuser_iden")?HD.$("curuser_iden").value:"",f=HD.$("editform")?HD.$("editform").action:"";HD.imageUploading=0;if(HD.util.isHudong()&&
e=="")return HD.plugin.tip.click(a,"\u63d0\u793a\uff1a\u53ea\u6709\u767b\u5f55\u7684\u7528\u6237\u624d\u53ef\u4ee5\u4e0a\u4f20\u56fe\u7247\u3002",function(){HD.plugin.login&&HD.plugin.login.show()});this.id=a;if(/^http:\/\/www\.hudong\.com\/navigation\.wiki/i.test(location.href))f="/editDoc.do";if(HD.util.isAtImg(a))return HD.util.showTip(a,"\u63d0\u793a\uff1a\u5f53\u524d\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0d\u9002\u5408\u518d\u6b21\u653e\u7f6e\u56fe\u7247\uff01");this.iden=e;this.doctitle=d;
this.docaction=f;this.tabName="upload";c='<li class="tab"><span id="dialog_span_upload" class="edion" onclick="HD.plugin[\'image\'].tab(\'upload\')"><b>\u4e0a\u4f20\u56fe\u7247\uff1a</b></span></li>\t\t<li><div id="dialog_li_upload"><input class="inp_txt" name="photofile" type="file" id="docphotofile" size="35" \t\tstyle="height:22px;width:280px;" onpaste="return false" onchange="HD.plugin[\'image\'].changeSrc(this)"/>\t\t<input type="hidden" name="img_src_action" id="img_src_action" value="'+f+'"/>\t\t<label class="gray">\u56fe\u7247\u683c\u5f0f\u4e3a\uff1ajpg\u3001gif\u3001png\uff0c\u5927\u5c0f\u4e3a1M(1024KB)\u4ee5\u5185</label>\t\t<img id="hd_img_checker" style="display:none"></div>\t\t<div id="dialog_li_url" style="display:none"><input name="img_url" id="img_url" idtype="text" style="height: 18px; width:286px;line-height:18px;" class="inp_txt"  max_length="200"/>        <label class="gray">\u6ce8\uff1a\u8bf7\u8f93\u5165\u4ee5jpg\u3001jpeg\u3001png\u3001gif\u7ed3\u675f\u7684url</label></div></li>\t\t<li><strong>\u56fe\u7247\u5927\u5c0f\uff1a</strong>\t\t<p><label for="hd_img_size_1"><img class="thumbnails" src="'+
c+'/spacer.gif"/>\t\t<input name="picWidthHeight" id="hd_img_size_1" type="radio" value="1" checked/> \t\t\u5927\u56fe<span class="gray">\uff08\u957f\u8fb9\uff1a'+(typeof g_img_big=="undefined"?"300":g_img_big)+'px\uff09</span></label></p>\t\t<p><label for="hd_img_size_2"><img class="enlarge" src="'+c+'/spacer.gif"/>\t\t<input name="picWidthHeight" id="hd_img_size_2" type="radio" value="2" /> \t\t\u5c0f\u56fe<span class="gray">\uff08\u957f\u8fb9\uff1a'+(typeof g_img_small=="undefined"?"140":g_img_small)+
'px\uff09</span></label></p>\t\t</li>\t\t<li><strong>\u5bf9\u9f50\u65b9\u5f0f\uff1a</strong>\t\t<p><label for="hd_img_align_left"><img class="toleft" src="'+c+'/spacer.gif"/>\t\t<input name="picAlign" id="hd_img_align_left" type="radio" value="left" /> \u56fe\u7247\u5c45\u5de6</p>\t\t<p><label for="hd_img_align_right"><img class="toright" src="'+c+'/spacer.gif"/>\t\t<input name="picAlign" id="hd_img_align_right" type="radio" value="right" checked/> \u56fe\u7247\u5c45\u53f3</p>\t\t</li>\t\t<li><strong>\u56fe\u7247\u63cf\u8ff0[<font color="red">\u5fc5\u586b</font>]\uff1a</strong>\t\t<textarea name="picAlt" maxlength="100" rows="2" style="width:290px;"></textarea>\t\t</li>\t\t<li id="hd_dialog_tip" class="hd-dialog-tip"> </li>';
HD.util.selection(a);a={id:a,cmd:"image",width:350,height:440,title:HD.lang.image,content:c,yesButton:HD.lang.yes,noButton:HD.lang.no,action:"index.php?attachment-uploadimg-"+(typeof g_docid=="undefined"?0:g_docid)};if(HD.util.isHudong())a.action="http://a5.att.hudong.com/uploadFileNew.wiki?curuser_iden="+e+"&doc_title="+encodeURI(d);(new HD.dialog2(a)).show();var g=document.getElementById("hd_img_checker");if(g)g.onreadystatechange=function(){if(g.readyState=="complete")if(g.fileSize>1048576){HD.imageSelectError=
1;b.error("\u63d0\u793a\uff1a\u56fe\u7247\u5927\u5c0f\u8d85\u8fc7\u9650\u5236\uff0c\u8bf7\u63a7\u5236\u57281M\u4ee5\u5185\uff01")}else HD.$("hd_dialog_tip").style.display="none"}},tab:function(a){var b=this,c=HD.g[this.id].form;this.tabName=a;c.removeAttribute("enctype");c.removeAttribute("encoding");if(a=="upload"){if(HD.browser=="CHROME"||/(Firefox\/[456789]|Gecko)/i.test(navigator.userAgent))c.setAttribute("enctype","multipart/form-data");else c.encoding?c.setAttribute("encoding","multipart/form-data"):
c.setAttribute("enctype","multipart/form-data");HD.$("dialog_span_upload").className="edion";HD.$("dialog_span_url").className="";setTimeout(function(){HD.$("dialog_li_upload").style.display="";HD.$("dialog_li_url").style.display="none";if(HD.util.isHudong()){var d="http://a5.att.hudong.com/uploadFileNew.wiki?curuser_iden="+b.iden+"&doc_title="+encodeURI(b.doctitle);c.action=d}},1)}else{if(HD.browser=="CHROME")c.setAttribute("enctype","application/x-www-form-urlencoded");else c.encoding?c.setAttribute("encoding",
"application/x-www-form-urlencoded"):c.setAttribute("enctype","application/x-www-form-urlencoded");HD.$("dialog_span_upload").className="";HD.$("dialog_span_url").className="edion";setTimeout(function(){HD.$("dialog_li_upload").style.display="none";HD.$("dialog_li_url").style.display="";if(HD.util.isHudong()){var d="http://a5.att.hudong.com/uploadUrl.wiki?curuser_iden="+b.iden+"&doc_title="+encodeURI(b.doctitle);c.action=d}},1)}},check:function(){return true},exec:function(a){if(HD.imageUploading==
1||HD.imageSelectError==1)return 0;this.id=a;var b=this,c=HD.g[a].form,d=HD.util.trim(c.picAlt.value);HD.util.select(a);a="";var e=/\.(jpg|jpeg|gif|png)$/i;if(HD.$("dialog_li_upload").style.display!="none"){a=HD.$("docphotofile").value;if(a==""||!a.match(e)){b.error("\u63d0\u793a\uff1a\u8bf7\u9009\u62e9\u4e00\u4e2a\u6709\u6548\u7684\u56fe\u7247\u6587\u4ef6\uff01");return false}HD.$("docphotofile").disabled=1}if(HD.$("dialog_li_url").style.display!="none"){a=HD.$("img_url").value;if(a==""||a.indexOf("http:")==
-1||!a.match(e)){b.error("\u63d0\u793a\uff1a\u8bf7\u8f93\u5165\u6709\u6548\u7684\u56fe\u7247url\uff01");c.img_url.focus();return false}}if(d==""){b.error("\u8bf7\u586b\u5199\u56fe\u7247\u63cf\u8ff0\uff0c\u826f\u597d\u7684\u63cf\u8ff0\u53ef\u4ee5\u5e2e\u52a9\u8bfb\u8005\u7406\u89e3\u56fe\u7247\uff01");c.picAlt.focus();return false}else if(d.length>500){b.error("\u8fc7\u591a\u7684\u56fe\u7247\u63cf\u8ff0\u53ef\u80fd\u4f1a\u5f71\u54cd\u9875\u9762\u5e03\u5c40\uff01");c.picAlt.focus();return false}b.error('<div class="hd_img_uploading">\u56fe\u7247\u4e0a\u4f20\u4e2d...</div>');
c.submit();HD.imageUploading=1;HD.event.add(HD.$("hd_iframe_submit"),"load",function(){setTimeout(function(){HD.imageUploading==1&&b.error();HD.imageUploading=0},1E3)});return false},insert:function(a,b){if(HD.imageUploading==0)return 0;HD.imageUploading=0;var c=this,d=this.id,e,f,g=HD.g[d].form;e=HD.util.trim(g.picAlt.value);e=HD.util.input(e);if(!e&&HD.$("_doc_title"))e=HD.$("_doc_title").value;if(!e&&HD.$("title"))e=HD.$("title").value;if(HD.$("hd_img_size_2").checked)a=a.replace("_s","_140");
g=g.picAlign;for(i=0;i<g.length;i++)if(g[i].checked){f=g[i].value;break}var h=new Image;h.onload=function(){var k="";if(HD.browser=="CHROME"||/AppleWebkit/i.test(navigator.userAgent)){f=f=="left"?"left":"right";k='<table align="'+f+'" class="img '+(f=="left"?"img_l":"img_r")+'" style="width:'+parseInt(h.width)+'px"><tr><td><A title="'+e+'" href="'+b+'" target=_blank><IMG title="'+e+'" alt="'+e+'" src="'+a+'"/></A></td></tr><tr><td>'+e+"</td></tr></table>&nbsp;"}else{f=f=="left"?"img_l":"img_r";k=
'<DIV class="img '+f+'" style="width:'+h.width+'"><A title="'+e+'" href="'+b+'" target=_blank><IMG title="'+e+'" alt="'+e+'" src="'+a+'"/></A><STRONG>'+e+"</STRONG></DIV>&nbsp;"}HD.util.insertHtml(d,k);HD.layout.hide(d);HD.util.focus(d);h.onload=function(){}};h.onerror=function(){c.error("\u63d0\u793a\uff1a\u56fe\u7247\u63d2\u5165\u5931\u8d25\uff01")};h.src=a},error:function(a){a||(a="\u63d0\u793a\uff1a\u56fe\u7247\u63d2\u5165\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u56fe\u7247");if(HD.$("docphotofile")||
HD.$("img_url")){if(HD.$("docphotofile"))HD.$("docphotofile").disabled=0;HD.$("hd_dialog_tip").style.display="block";HD.$("hd_dialog_tip").innerHTML=a}}};
